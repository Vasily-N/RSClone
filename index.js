(()=>{"use strict";var t={2884:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"5b15b3951232d1d89d9b80de5758b4df.wav"},1895:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"4752f2fb6130d737b5fa651396b09ba5.wav"},9907:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"f618afc296cbdc1d1731da863fb803b9.wav"},4830:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"41c35a7d4a2e0d9e7f7d11df6e47c271.wav"},9488:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"6a171baea2f666560ef3555e125fcb10.wav"},5225:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"9ab32d21414562a962d714f5c89e50c0.png"},1978:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"f027066d86690d8d78f29c012ef10c5d.png"},2420:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"d2a1024a482919d4e3cce132a20465ba.png"},4700:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"cbb854cbac2fe31465638ae5ca75d78d.png"},1038:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"146dd590ebf12a14ed6477cba2bb37a8.png"},1697:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"d388d3c3aa833699d132fce7931f0bad.png"},5674:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"f8b794eee158d45103b5ff4d7ec49d38.png"},333:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"340fb47fe5db94b7be1c182b5a72225c.png"},4640:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"902c8b5dde084f3476add9da826e54fd.png"},8240:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"622dc259cbaef85139c04820e43863e3.png"},5428:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"ad7fcca26eabb09bf71818d7813a7bd0.png"},1646:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"700e35fbb82391ecc35a50805371d4de.png"},6892:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"e02186872cf458a8ca1eed96d8b90184.png"},2170:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"37c4eee04515ef0894ec994b5305530f.png"},1216:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"3554822b2da1e471e2fa318af8d07f04.png"},5314:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"2418780abbe426020d5e87c91479b751.png"},6238:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"a2d9fcfc0d90b528c4ceb75176e38a01.png"},3201:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"b9b39b13358633c746f16b9681c3ede7.png"},3235:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"aeb4f1e897feb1c2fe0a0c3a7b40cdf6.png"},7970:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"65a32f931abeb1e7f59d3501d137cd62.png"},9999:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"593a4b3f070296e009057da3f1476944.png"},8654:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"19a1f869e3e2444f0bca3696121ac906.png"},6526:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"8dc53096272087291ff13609fc7d82ed.png"},9143:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"565d7ce9419799b8e957db9f1dc19478.png"},3699:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"1d2ae61d1826550d3f6662fe5b84df31.png"},714:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"f8170665bef973ce784cecafcbb5e4b3.png"},6911:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"01e9078b8e3b645ce6760e6d639d7368.mp3"},1362:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"d746ed695504ff8244ae43a46d88c5b8.mp3"},3730:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"ac9199a8c825bc3af1edc90dfaeb299f.mp3"},8562:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"7d5024e27dde5fc8eef92fbb500f3670.mp3"},8239:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"5c0e80afde65976b83e4f7c26c35cf8b.jpg"},8096:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i=n.p+"ca0731556bacb0544cff2ecb234679f8.svg"},5591:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<nav class="{{navigation}}"> <button id="toMainPage" class="{{button}} {{button_1}}">TO MAIN PAGE</button> <button id="toCanvas" class="{{button}} {{button_1}}">TO CANVAS</button> <button id="toPlaceholder" class="{{button}} {{button_1}}">TO BOARDERS</button> <button id="toSettingGame" class="{{button}} {{button_1}}">Setting Game</button> <button id="toSettingControl" class="{{button}} {{button_1}}">Setting Control</button> <button id="settingSound" class="{{button}} {{button_1}}">Setting Sound</button> </nav> <div id="sounds" class="{{sounds}}"></div> <main class="{{content}}"></main> '},8290:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<form class="{{auth}}" id="auth"> <input class="{{input-auth}}" type="text" placeholder="Username" id="name-auth" required> <input class="{{input-auth}}" type="password" placeholder="Password" id="pass-auth" required> <div class="{{checkPass}}"> <input type="checkbox" id="togglePassVisibility">Show Password </div> <button class="{{auth-btn}}" type="submit" id="auth-user">LogIn</button> <p class="{{skip}}" id="auth-skip">continue without authorization</p> <button type="button" class="{{start-btn}}" id="startBtn">Start Game!</button> <p class="{{error-message}}" id="errorMessage">no such user exists</p> <p class="{{error-message}}" id="errorEmpty">not enough data</p> </form> '},5799:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<div class="{{tables}}"> <div class="{{times}}"> <p>The best Times</p> <table> <thead> <tr> <th>Name</th> <th>Time</th> <th>Date</th> </tr> </thead> <tbody class="{{time-table}}" id="timeTable"> <tr> <td>-</td> <td>-</td> <td>-</td> </tr> </tbody> </table> </div> <div class="{{wins}}"> <p>Result data</p> <table> <thead> <tr> <th>Name</th> <th>Result</th> <th>Date</th> </tr> </thead> <tbody class="{{win-table}}" id="winTable"> <tr> <td>-</td> <td>-</td> <td>-</td> </tr> </tbody> </table> </div> </div> '},4340:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<div class="canvas"> <div id="hp" class="{{hp}}">&nbsp;</div> <canvas id="canvas" class="{{canvas}}"></canvas> </div> '},9366:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<form class="{{reg}}" id="reg"> <input class="{{input-auth}}" type="text" placeholder="Username" id="name-reg" required> <input class="{{input-auth}}" type="password" placeholder="Password" id="pass-reg" required> <div class="{{checkPass}}"> <input type="checkbox" id="togglePassVisibilityReg">Show Password </div> <button class="{{reg-btn}}" type="submit" id="reg-user">Registration</button> <p class="{{skip}}" id="reg-skip">continue without authorization</p> <button type="button" class="{{start-btn}}" id="startBtn">Start Game!</button> <p class="{{error-message}}" id="errorMessage">this name already taken</p> <p class="{{error-message}}" id="errorEmpty">not enough data</p> </form> '},7509:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<div class="setting__class" id="setting__class"></div>'},3956:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<div class="setting__control" id="setting__control"> <div class="color" id="color">sertting control</div> </div>'},119:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<div class="setting__game"> <p>Draw Boxes</p> <div> <input type="checkbox" class="{{check-box}}" id="boxes__drow" value="true"> </div> <p>Draw Surfaces</p> <div> <input type="checkbox" class="{{check-box}}" id="draw__surfaces" value="true"> </div> <p>Fps Display</p> <div> <input type="checkbox" class="{{check-box}}" id="fps__display" value="true"> </div> <p>Choose Fps Limit</p> <input type="number" id="fps__Limit" min="0" max="80"/> <p>size zoom of game</p> <select id="zoom__game"> <option selected="selected" disabled="disabled" hidden>Choose here</option> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> </select> </div>'},1465:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<p>Audio settings:</p> <div> <input type="range" id="music" name="music" min="0" max="100"> <label for="music">Music Volume</label> </div> <div> <input type="range" id="Sounds" name="Sounds" min="0" max="100"> <label for="cowbell">Sounds Volume</label> </div>'},4112:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<audio id="music" autoplay="true"></audio> <div id="sounds"></div>'},1996:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i='<div class="{{start-page}}" id="startPage"> <div class="{{menu}}" id="buttons"> <button id="toSettingGame" class="{{menu-button}}">SETTINGS</button> <button id="login" class="{{menu-button}}">LogIn</button> <button id="registration" class="{{menu-button}}">Registration</button> <button id="boarders" class="{{menu-button}}">BOARDERS</button> </div> <div class="{{contacts}}"> <a href="https://rs.school/js/" class="{{courseLogo}}" id="rsLogo"> <img id="logo" class="{{logo}}"> </a> <a href="https://github.com/Vasily-N" class="{{developer}}">Vasily-N</a> <a href="https://github.com/HolyOly" class="{{developer}}">Oly</a> <a href="https://github.com/BurakMikita" class="{{developer}}">BurakMikita</a> <span>&#169;2022</span> </div> </div> <div class="{{modal}}" id="modal"> <span class="{{close}}" id="close"></span> <div class="{{content}}" id="modalContent"></div> </div> '},3535:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={button:"app__button",button_1:"app__button_1",button_disabled:"app__button_disabled",content:"app__content",navigation:"app__navigation"}},8069:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={"input-auth":"auth__input-auth",reg:"auth__reg",auth:"auth__auth",skip:"auth__skip","reg-btn":"auth__reg-btn","auth-btn":"auth__auth-btn","start-btn":"auth__start-btn","error-message":"auth__error-message"}},4392:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={tables:"boarders__tables"}},90:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={bg:"canvas__bg",canvas:"canvas__canvas"}},9762:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={"input-auth":"reg__input-auth",reg:"reg__reg",auth:"reg__auth",skip:"reg__skip","reg-btn":"reg__reg-btn","auth-btn":"reg__auth-btn","back-darker":"reg__back-darker","start-btn":"reg__start-btn","error-message":"reg__error-message"}},1260:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={box:"settingControl__box",setting__control:"settingControl__setting__control"}},3804:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={}},4376:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={}},6125:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={}},2149:(t,e,n)=>{n.r(e),n.d(e,{default:()=>i});const i={"start-page":"startPage__start-page",menu:"startPage__menu","menu-button":"startPage__menu-button",contacts:"startPage__contacts",developer:"startPage__developer",logo:"startPage__logo",modal:"startPage__modal",close:"startPage__close","darken-overlay":"startPage__darken-overlay"}},1495:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(1999),o=n(4354),a=n(7037),r=n(786),l=i(n(9457));class u{constructor(){this.contolsSettings=new s.ControlsSettings,new s.Api("http://localhost:3000/");const t=new s.SoundPlay,e={controls:{settings:new s.ControlsSettings,action:s.ControlsAction},gameSettings:new s.GameSettings,sounds:{subsribe:t,settings:t,play:t},api:{wins:new a.WinServices(new s.Api("https://castledeploy.herokuapp.com/api/"),"wins",{}),times:new o.TimeServices(new s.Api("https://castledeploy.herokuapp.com/api/"),"times",{}),users:new r.UserServices(new s.Api("https://castledeploy.herokuapp.com/api/"),"users",{})}};this.page=new l.default("body",e)}start(){this.page.append(),u.taskConsole()}static taskConsole(){}}e.default=u},4192:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=n(3427);e.default=class{constructor(t,e=!1){this.rect=new i.Rectangle(e?t.X:t.X-t.Width/2,e?t.Y:-t.Y,t.Width,t.Height),this.rectReverse=new i.Rectangle(-this.rect.Right,this.rect.Top,t.Width,t.Height)}getRect(t){return t?this.rectReverse:this.rect}static initCombined(t,e){const n=Math.min(t.X,e.X),s=Math.max(t.X+t.Width,e.X+e.Width),o=Math.min(t.Y,e.Y),a=Math.max(t.Bottom,e.Bottom);return i.Rectangle.fromLine(new i.Line(new i.Point(n,o),new i.Point(s,a)))}hit(t){throw new Error("Box.hit is not implemented!")}draw(t,e,n,i){const s=this.getRect(i),o=Math.round(e.X+s.X*n),a=Math.round(e.Y+s.Y*n);t.strokeRect(o,a,s.Width*n,s.Height*n)}}},4241:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(309),o=n(5861),a=n(3427),r=n(7238),l=i(n(9770)),u=i(n(7969)),c=i(n(6514));class d extends o.Entity{constructor(t){super(a.Point.Zero,r.states),this.airJumps=1,this.jumpHold=!1,this.didAFlip=!1,this.conrols=t}get VelocityX(){return this.velocityPerSecond.X}get VelocityY(){return this.velocityPerSecond.Y}static getMaxVelX(t){return t?d.maxVelX.run:d.maxVelX.walk}getXVelChangePerSec(){return this.OnSurface?d.changeVelX[this.surfaceType]||d.changeVelX.default:d.changeVelX.air}processWalk(t){const e=Math.max(Math.abs(this.velocityPerSecond.X),d.getMaxVelX(this.conrols.has(s.ControlsAction.run)));this.velocityPerSecond.X=this.direction?Math.max(this.velocityPerSecond.X-t,-e):Math.min(this.velocityPerSecond.X+t,e)}processSlowDown(t){this.OnSurface&&(this.velocityPerSecond.X=this.velocityPerSecond.X<0?Math.min(this.velocityPerSecond.X+t,0):Math.max(this.velocityPerSecond.X-t,0))}processJump(){if(this.OnSurface&&(this.airJumps=d.maxAirJumps),!this.conrols.has(s.ControlsAction.jump))return this.jumpHold=!1,!1;if(this.jumpHold)return!1;if(this.OnSurface)this.surfaceType=null;else{if(!this.airJumps)return!1;this.airJumps-=1}const t=this.stateCurrent===r.CharacterState.Sit;if(t&&!this.platform)return!1;c.default.sound(u.default.jump);const e=t&&this.platform;return e?this.Position.Y+=2:this.velocityPerSecond.Y=-d.jumpPower,this.State=r.CharacterState.Walk,this.jumpHold=!0,e}processActions(t,e){for(let n=t.length-1;n>-1;n-=1)if(this.conrols.has(t[n]))return this.stateElapsedSeconds=0,this.State=e[n],!0;return!1}processAttack(){return!!this.processActions(d.attackKeys,d.attackValues)&&(c.default.sound(d.attackSounds[this.stateCurrent]),!0)}processFlip(){if(this.OnSurface)return this.didAFlip=!1,!1;if(this.didAFlip)return!1;if(this.didAFlip=this.processActions(d.flipKeys,d.flipValues),!this.didAFlip)return!1;c.default.sound(u.default.spin);const t=60*(this.stateCurrent===r.CharacterState.FlipBack?-1:1);return this.velocityPerSecond.X=t<0?Math.min(this.velocityPerSecond.X,t):Math.max(this.velocityPerSecond.X,t),this.velocityPerSecond.Y=-130,this.direction&&(this.State=d.flipReverse[this.stateCurrent]),!0}longAnimationCheck(t){return d.longStates.includes(this.stateCurrent)&&!!this.animation&&!o.Entity.animationFinished(this.animation,this.stateElapsedSeconds+t)}processControls(t){this.OnSurface&&d.flipValues.includes(this.stateCurrent)&&(this.State=r.CharacterState.Walk);const e=this.longAnimationCheck(t)||this.processAttack()||this.processFlip(),n=this.conrols.has(s.ControlsAction.moveLeft),i=this.conrols.has(s.ControlsAction.moveRight),a=this.conrols.has(s.ControlsAction.sit),l=t*this.getXVelChangePerSec();e||(i&&(this.direction=o.Direction.right),n&&(this.direction=o.Direction.left));const u=n||i;return(a||e||!u)&&this.processSlowDown(l),!e&&(u&&!a?(this.processWalk(l),this.State=r.CharacterState.Walk):this.OnSurface?this.State=a?r.CharacterState.Sit:r.CharacterState.Idle:this.State=r.CharacterState.Walk,this.processJump())}frame(t){const e=this.processControls(t);return super.frame(t),e}levelLoad(t){this.position.X=t.X,this.position.Y=t.Y}}d.maxVelX={walk:100,run:180},d.changeVelX={default:1500,air:180,[l.default.Ice]:100},d.maxAirJumps=1,d.jumpPower=160,d.attackStates={[s.ControlsAction.attackLight]:r.CharacterState.AttackNormal,[s.ControlsAction.attackHeavy]:r.CharacterState.AttackHeavy,[s.ControlsAction.attackRange]:r.CharacterState.AttackRange},d.attackSounds={[r.CharacterState.AttackNormal]:u.default.light,[r.CharacterState.AttackHeavy]:u.default.heavy,[r.CharacterState.AttackRange]:u.default.gun},d.attackKeys=Object.keys(d.attackStates),d.attackValues=Object.values(d.attackStates),d.flipStates={[s.ControlsAction.flipRight]:r.CharacterState.FlipForward,[s.ControlsAction.flipLeft]:r.CharacterState.FlipBack},d.flipReverse={[r.CharacterState.FlipBack]:r.CharacterState.FlipForward,[r.CharacterState.FlipForward]:r.CharacterState.FlipBack},d.flipKeys=Object.keys(d.flipStates),d.flipValues=Object.values(d.flipStates),d.longStates=[...d.attackValues,...d.flipValues],e.default=d},7969:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(9907)),o=i(n(2884)),a=i(n(1895)),r=i(n(4830)),l=i(n(9488)),u={jump:s.default,gun:o.default,heavy:a.default,light:r.default,spin:l.default};e.default=u},8074:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(5225)),o=n(3427),a={link:s.default,frameLength:1/12,frameSize:75,vertical:!0,hasReverse:!0,position:new o.Point(10,1)};e.default=a},5360:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(1978)),o=n(3427),a={link:s.default,frameLength:1/15,frameSize:42,vertical:!0,hasReverse:!0,position:new o.Point(4,0)};e.default=a},7715:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(2420)),o=n(3427),a={link:s.default,frameLength:1/15,frameSize:44,vertical:!0,hasReverse:!0,position:new o.Point(12,0)};e.default=a},3643:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(4700)),o=i(n(6588));e.default=Object.assign(Object.assign({},o.default),{link:s.default})},1960:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(1038)),o=i(n(6588));e.default=Object.assign(Object.assign({},o.default),{link:s.default})},6588:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={link:"",frameLength:.05,frameSize:37,vertical:!0,hasReverse:!0}},9773:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s={link:i(n(1697)).default,frameLength:1/15,frameSize:44,vertical:!0,hasReverse:!0};e.default=s},2355:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s={link:i(n(5674)).default,frameLength:1/15,frameSize:23,vertical:!0,hasReverse:!0};e.default=s},1083:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(333)),o=n(3427),a={link:s.default,frameLength:1/15,frameSize:43,vertical:!0,hasReverse:!0,position:new o.Point(-4,0)};e.default=a},7238:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.states=e.CharacterState=void 0;const s=n(3427),o=i(n(4192)),a=i(n(1083)),r=i(n(9773)),l=i(n(2355)),u=i(n(5360)),c=i(n(8074)),d=i(n(7715)),h=i(n(3643)),f=i(n(1960));var m;!function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Run=2]="Run",t[t.Jump=3]="Jump",t[t.Sit=4]="Sit",t[t.AttackNormal=5]="AttackNormal",t[t.AttackHeavy=6]="AttackHeavy",t[t.AttackRange=7]="AttackRange",t[t.FlipBack=8]="FlipBack",t[t.FlipForward=9]="FlipForward"}(m||(m={})),e.CharacterState=m;const p=new o.default(new s.Rectangle(0,42,14,40)),w=new o.default(new s.Rectangle(2,40,10,36)),P=new o.default(new s.Rectangle(2,6,14,6)),g=new o.default(new s.Rectangle(18,36,26,4)),v=new o.default(new s.Rectangle(2,42,14,42)),b=new o.default(new s.Rectangle(-4,22,18,22)),S=[new o.default(new s.Rectangle(-20,60,30,36)),new o.default(new s.Rectangle(5,76,60,40)),new o.default(new s.Rectangle(36,64,40,60))],_=new o.default(new s.Rectangle(114,40,180,4)),y={[m.Idle]:{sprite:r.default,collisionbox:v,hurtbox:p},[m.Walk]:{sprite:a.default,collisionbox:v,hurtbox:w,hitbox:P},[m.Sit]:{sprite:l.default,collisionbox:v,hurtbox:b},[m.AttackNormal]:{sprite:u.default,collisionbox:v,hurtbox:p,hitbox:g},[m.AttackHeavy]:{sprite:c.default,collisionbox:v,hurtbox:p,hitboxes:S},[m.AttackRange]:{sprite:d.default,collisionbox:v,hurtbox:p,hitbox:_},[m.FlipBack]:{sprite:h.default,collisionbox:v,hurtbox:p},[m.FlipForward]:{sprite:f.default,collisionbox:v,hurtbox:p}};e.states=y},1431:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=n(5861),s=n(7891);class o extends i.Entity{constructor(t){super(t,s.states)}}e.default=o},7891:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.states=e.PlaceholderState=void 0,function(t){t[t.Idle=0]="Idle"}(n||(n={})),e.PlaceholderState=n;const i={[n.Idle]:{}};e.states=i},5861:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.EntityId=e.Direction=e.Entity=void 0;const s=n(7661);Object.defineProperty(e,"Direction",{enumerable:!0,get:function(){return s.Direction}}),Object.defineProperty(e,"EntityId",{enumerable:!0,get:function(){return s.EntityId}});const o=n(9325),a=n(3427),r=i(n(4192));class l{constructor(t,e,n){this.direction=s.Direction.right,this.position=a.Point.Zero,this.velocityPerSecond=a.Point.Zero,this.gravity=230,this.states={},this.stateElapsedSeconds=0,this.stateCurrent=-1,this.animation=null,this.collisionBox=null,this.platform=!1,this.surfaceType=null,this.position=t,e&&(this.states=l.initStates(e),this.State=n||Number(Object.keys(e)[0]))}get Direction(){return this.direction}get Position(){return this.position}get Collision(){var t;return(null===(t=this.collisionBox)||void 0===t?void 0:t.getRect(!!this.direction))||a.Rectangle.Zero}set SurfaceType(t){this.surfaceType=t,null!==t&&this.resetVelocityY()}set Surface(t){this.SurfaceType=t&&t.type,this.platform=!!t&&t.platform}get OnSurface(){return null!==this.surfaceType}static getCollisionSimplified(t){return t.map((t=>t.getRect())).reduce(((t,e)=>r.default.initCombined(t,e)),new a.Rectangle(0,0,0,0))}set State(t){if(!this.states[t])return this.stateCurrent=-1,this.animation=null,void(this.collisionBox=null);t!==this.stateCurrent&&(this.stateElapsedSeconds=0,this.stateCurrent=t,[this.collisionBox]=this.states[this.stateCurrent].collisionboxes,this.animation=this.states[this.stateCurrent].animation||null)}static concatBoxes(t,e){return(e||[]).concat(t||[])}static initStates(t){return Object.keys(t).reduce(((e,n)=>{const i=t[+n],s=l.concatBoxes(i.hitbox,i.hitboxes),a=l.concatBoxes(i.hurtbox,i.hurtboxes),u=a.length?a:s,c=l.concatBoxes(i.collisionbox,i.collisionboxes),d={hitboxes:s,hurtboxes:u,collisionboxes:[new r.default(l.getCollisionSimplified(c.length?c:a),!0)]};return i.sprite&&Object.assign(d,{animation:new o.SpriteAnimation(i.sprite)}),Object.assign(e,{[+n]:d}),e}),{})}frame(t){return this.stateElapsedSeconds+=t,!this.OnSurface&&this.velocityPerSecond.Y<l.maxVelY&&(this.velocityPerSecond.Y+=t*this.gravity,this.velocityPerSecond.Y=Math.min(this.velocityPerSecond.Y,l.maxVelY)),this.position.Y+=t*this.velocityPerSecond.Y,this.position.X+=t*this.velocityPerSecond.X,!1}resetVelocityX(){this.velocityPerSecond.X=0}resetVelocityY(t=!1,e=!1){(!t&&!e||t&&this.velocityPerSecond.Y<0||e&&this.velocityPerSecond.Y>0)&&(this.velocityPerSecond.Y=this.gravity/5)}static drawPosition(t,e){const n=t;n.strokeStyle=l.colors.position,n.fillRect(Math.round(e.X),Math.round(e.Y),1,1)}drawBoxes(t,e,n){if(this.stateCurrent<0)return;const i=this.states[this.stateCurrent],s=!!this.direction,o=t;t.translate(.5,.5),o.strokeStyle=l.colors.collision,i.collisionboxes.forEach((i=>i.draw(t,n,e,s))),o.strokeStyle=l.colors.hurt,i.hurtboxes.forEach((i=>i.draw(t,n,e,s))),o.strokeStyle=l.colors.hit,i.hitboxes.forEach((i=>i.draw(t,n,e,s))),l.drawPosition(t,n),t.translate(-.5,-.5)}draw(t,e,n,i=!1){const s=this.position.multiply(n).minus(e);if(this.animation){const e=this.stateElapsedSeconds;this.animation.drawFrame(t,s,n,e,!!this.direction)}i&&this.drawBoxes(t,n,s)}static animationFinished(t,e){return t.Ends<=e}}e.Entity=l,l.maxVelY=400,l.colors={hit:"red",hurt:"blue",collision:"fuchsia",position:"green"}},1255:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(5861),o=i(n(1431)),a={[s.EntityId.Placeholder]:o.default};e.default=a},1929:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.right=0]="right",t[t.left=1]="left"}(n||(n={})),e.default=n},9904:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Placeholder=0]="Placeholder"}(n||(n={})),e.default=n},7661:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.EntityId=e.Direction=void 0;const s=i(n(1929));e.Direction=s.default;const o=i(n(9904));e.EntityId=o.default},4989:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;const s=i(n(4241)),o=n(309),a=n(2714),r=n(9225),l=i(n(6514));class u{constructor(t,e,n){this.lastFrame=0,this.levels={},this.levelCurrent=this.getLevel(r.LevelId.WinTheGame),this.pause=!1,this.totalElapsed=0,l.default.setSoundPlay(n),this.controls=new o.Controls(t),this.char=new s.default(this.controls),this.gameSettings=e}start(t){this.levelCurrent=this.changeLevel({levelId:r.LevelId.Beggining,zone:0,position:0}),this.requestNextFrame(),this.totalElapsed=0,this.report=t}getLevel(t){return this.levels[t]||(this.levels[t]=new a.Level(r.levelList[t])),this.levels[t]}changeLevel(t){const e=this.levelIdCurrent===t.levelId,n=e?this.levelCurrent:this.getLevel(t.levelId);return e||(this.levelIdCurrent=t.levelId),n.load(this.char,t.zone,t.position,e),n}requestNextFrame(){window.requestAnimationFrame(this.frame.bind(this))}static drawFps(t,e,n){const i=t;i.font=`${e}px serif`,i.fillStyle="white",i.fillText(`FPS: ${(1e3/n).toFixed(1)}`,5,e)}static timePad(t,e=2){return`${t}`.padStart(e,"0")}static timeSpanToString(t){return`${u.timePad(t.getUTCHours())}:${u.timePad(t.getMinutes())}:${u.timePad(t.getUTCSeconds())}.${u.timePad(t.getUTCMilliseconds(),3)}`}static drawTime(t,e,n){const i=t;i.font=`${e}px serif`,i.fillStyle="white",i.fillText(u.timeSpanToString(new Date(1e3*n)),5,2*e)}processFrame(t){const e=this.gameSettings.getRenderZone();if(!e)throw u.RenderError;if(!this.levelCurrent)return!1;e.lineWidth=3,e.imageSmoothingEnabled=!1;const{RenderSize:n,Zoom:i}=this.gameSettings;e.clearRect(0,0,n.X,n.Y);const s=Math.min(t/1e3,this.gameSettings.FrameTimeLimitMin);this.totalElapsed+=s;const o=this.levelCurrent.frame(s,n,i);return(null==o?void 0:o.levelId)===r.LevelId.WinTheGame||(this.levelCurrent.draw(e,i,this.gameSettings.DrawBoxes,this.gameSettings.DrawSurfaces),this.gameSettings.FpsDisplay&&u.drawFps(e,u.fontSize,t),this.gameSettings.TimeDisplay&&u.drawTime(e,u.fontSize,this.totalElapsed),o&&(this.levelCurrent=this.changeLevel(o)),!1)}frame(t){this.controls.has(o.ControlsAction.pause,!0)&&this.pauseToggle();const e=t-this.lastFrame;if(this.controls.has(o.ControlsAction.zoomUp,!0)&&(this.gameSettings.Zoom+=1),this.controls.has(o.ControlsAction.zoomDown,!0)&&(this.gameSettings.Zoom-=1),!Number.isFinite(this.gameSettings.FrameTimeLimit)||e>=this.gameSettings.FrameTimeLimit){if(this.lastFrame&&!this.pause&&this.processFrame(e)){const t=this.totalElapsed;return void(this.report&&this.report.winTheGame&&this.report.winTheGame({elapsedSeconds:t}))}this.lastFrame=t}this.requestNextFrame()}pauseToggle(){this.pause=!this.pause,this.report&&this.report.pauseTheGame&&this.report.pauseTheGame()}}e.Game=u,u.RenderError=new Error("the game can't process without canvas"),u.fontSize=24},7017:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.positionsFromPoints=void 0;const s=i(n(7737));e.positionsFromPoints=s.default},7737:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=n(3427);e.default=function(t,e,n){return t.reduce(((t,e)=>{var n;return t.concat(new i.Line((null===(n=t.at(-1))||void 0===n?void 0:n.B)||i.Point.Zero,e))}),[]).slice(1).map((t=>Object.assign(Object.assign({position:t},n&&{type:n}),e&&{platform:e})))}},5135:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=n(3427);class s{constructor(t){this.target=i.Point.Zero,this.current=i.Point.Zero,this.lastZoom=-1,this.lastViewSize=i.Point.Zero,this.area=t}get Current(){return this.current}resetPosition(){this.lastZoom=-1}process(t,e,n,i){const o=this.area.multiply(n);if(e.X>o.Size.X)this.target.X=(o.Size.X-e.X)/2,this.current.X=this.target.X;else{const a=.5+(t.Direction?s.cameraShift.X:-s.cameraShift.X),r=n*t.Position.X-e.X*a,l=o.Size.X-e.X;if(this.target.X=Math.min(Math.max(r,o.X),l),this.current.X!==this.target.X){const e=this.current.X+i*t.VelocityX*n;this.current.X=Math.min(Math.max(e,o.X),l)}}if(e.Y>o.Size.Y)this.current.Y=(o.Size.Y-e.Y)/2;else{const i=s.cameraShift.Y,a=n*t.Position.Y-e.Y*i,r=o.Size.Y-e.Y;this.current.Y=Math.min(Math.max(a,o.Y),r)}if(this.lastZoom!==n||this.lastViewSize!==e)this.current.X=this.target.X,this.lastZoom=n,this.lastViewSize=e;else if(this.current.X!==this.target.X){const t=i*s.cameraSpeed*Math.sqrt(n);this.current.X=this.current.X>this.target.X?Math.max(this.current.X-t,this.target.X):Math.min(this.current.X+t,this.target.X)}}}s.cameraSpeed=90,s.cameraShift=new i.Point(1/15,6/11),e.default=s},6603:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=n(3427);class s{static filterNear(t,e){return t.filter((t=>t.position.MinX<=e.Right&&t.position.MaxX>=e.Left&&t.position.MinY<=e.Bottom&&t.position.MaxY>=e.Top))}static linesIntersect(t,e){const n=t.B.minus(t.A),i=e.B.minus(e.A),s=(i.X*(t.A.Y-e.A.Y)-i.Y*(t.A.X-e.A.X))/(n.X*i.Y-n.Y*i.X);if(s<0||s>1||Number.isNaN(s))return null;const o=(n.X*(t.A.Y-e.A.Y)-n.Y*(t.A.X-e.A.X))/(n.X*i.Y-i.X*n.Y);return o<0||o>1||Number.isNaN(o)?null:s}static percentOnLine(t,e,n){return Math.abs(t-e)/n}static getCheckZone(t){const e=Math.floor(t.MinY),n=Math.ceil(t.MaxY-e),s=Math.floor(t.MinX),o=Math.ceil(t.MaxX-s);return new i.Rectangle(s,e,o,n)}static processExitZones(t,e){const n=s.filterNear(t,s.getCheckZone(e));if(!n.length)return null;for(let t=n.length-1;t>-1;t-=1){const o=n[t],a=o.position;let r=s.linesIntersect(a,e);if(null===r){const t=new i.Line(e.A,new i.Point(e.B.X,e.A.Y));if(r=s.linesIntersect(a,t),null===r)continue}if(e.A.X!==o.position.MinX||e.A.X!==o.position.MaxX)return{levelId:o.levelId,zone:o.zone,position:r}}return null}static processFloorsDot(t,e,n,o){if(!e.length)return null;e.length>1&&e.sort(((t,e)=>e.position.MaxY-t.position.MaxY));for(let a=e.length-1;a>-1;a-=1){const r=e[a].position,l=s.percentOnLine(n.A.X,r.A.X,r.DifXabs);if(r.DifYabs*l+r.MinY<n.A.Y-(o?t.Collision.Height:0))continue;const u=s.percentOnLine(n.B.X,r.A.X,r.DifXabs),c=r.DifYabs*u+r.MinY;if(o||!(c>n.B.Y))return{surface:e[a],point:new i.Point(n.B.X,c-.16)}}return null}static processFloorSub(t,e,n,i,o){const a=s.filterNear(e,n);return s.processFloorsDot(t,a,i,o)}static processFloor(t,e,n){const o=Math.floor(n.MinY-t.Collision.Height/4),a=Math.ceil(n.MaxY-o+t.Collision.Height/4),r=new i.Rectangle(n.B.X,o,0,a);return s.processFloorSub(t,e,r,n,t.OnSurface)||null}static processCeilDot(t,e){if(!t.length)return null;t.length>1&&t.sort(((t,e)=>-(e.position.MaxY-t.position.MaxY)));for(let n=t.length-1;n>-1;n-=1){const o=t[n].position,a=s.percentOnLine(e.A.X,o.A.X,o.DifXabs);if(o.DifYabs*a+o.MinY>e.A.Y)continue;const r=s.percentOnLine(e.B.X,o.A.X,o.DifXabs),l=o.DifYabs*r+o.MinY;if(!(l<e.B.Y))return{surface:t[n],point:new i.Point(e.B.X,l)}}return null}static processCeil(t,e,n){const o=e.Collision.plusPoint(e.Position),a=new i.Line(new i.Point(n.A.X,n.A.Y-o.Height),new i.Point(n.B.X,n.B.Y-o.Height)),r=Math.floor(a.MinY),l=o.Left+s.ceilThr,u=Math.ceil(a.MaxY-r),c=o.Width-2*s.ceilThr,d=new i.Rectangle(l,r,c,u),h=s.filterNear(t,d);return s.processCeilDot(h,a)}static RayVsRect(t,e){const n=t.A,s=t.Direction,o=new i.Point(1/s.X,1/s.Y),a=e.Position.minus(n).multiplyPoint(o),r=e.BottomRight.minus(n).multiplyPoint(o);if(Number.isNaN(r.Y)||Number.isNaN(r.X))return null;if(Number.isNaN(a.Y)||Number.isNaN(a.X))return null;if(a.X>r.X&&([a.X,r.X]=[r.X,a.X]),a.Y>r.Y&&([a.Y,r.Y]=[r.Y,a.Y]),a.X>r.Y||a.Y>r.X)return null;const l=Math.max(a.X,a.Y),u=Math.min(r.X,r.Y);if(u<0)return null;const c=n.plus(s.multiply(l)),d=n.plus(s.multiply(u));return new i.Line(c,d)}static processWalls(t,e,n){const o=e.Collision,a=o.plusPoint(e.Position),r=a.minusPoint(n.Direction),l=i.Rectangle.fromLine(new i.Line(new i.Point(Math.min(a.Left,r.Left),Math.min(a.Top,r.Top)),new i.Point(Math.max(a.Right,r.Right),Math.max(a.Bottom,r.Bottom)))),u=s.filterNear(t,l);for(let t=u.length-1;t>-1;t-=1){const e=u[t].position,s=this.RayVsRect(e,a);if(s){if(r.Bottom<=e.MinY)return{surface:u[t],point:new i.Point(n.B.X,e.MinY)};if(r.Top>=e.MaxY)return{point:new i.Point(n.B.X,e.MaxY+o.Height+1)};if((null==s?void 0:s.A.X)===(null==s?void 0:s.B.X))return{point:new i.Point(r.X<a.X?e.MinX-o.Right-.33:e.MaxX-o.Left+.33,n.B.Y)};throw new Error("why do you have not straigh walls?!")}}return null}static processCeil2(t,e,n){const o=e.Collision,a=o.plusPoint(e.Position),r=a.minusPoint(n.Direction),l=s.filterNear(t,a);for(let t=l.length-1;t>-1;t-=1){const e=l[t].position,u=s.RayVsRect(e,a);if(!u)continue;if(Math.abs(e.MinX-u.A.X)<Math.abs(u.B.X-e.MaxX)){if(e.MinX<a.Left)continue;const s=e.MinX===e.B.X?e.B.Y:e.A.Y,u=e.MinY!==e.MaxY&&s===e.MinY?.48:0;if(r.Bottom<=s+u){if(a.Bottom<s-u)continue;return{surface:l[t],point:new i.Point(n.B.X,s-o.Bottom-u)}}if(e.MinX+4<r.Right)continue;return{point:new i.Point(e.MinX-o.Right,n.B.Y)}}if(e.MaxX>a.Right)continue;const c=e.MaxX===e.A.X?e.A.Y:e.B.Y,d=e.MinY!==e.MaxY&&c===e.MinY?.48:0;if(r.Bottom<=c+d){if(a.Bottom<c-d)continue;return{surface:l[t],point:new i.Point(n.B.X,c-o.Bottom-d)}}if(!(e.MaxX-4>r.Left))return{point:new i.Point(e.MaxX-o.Left,n.B.Y)}}return null}}s.ceilThr=1.5,e.default=s},9074:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Collision=e.Camera=void 0;const s=i(n(5135));e.Camera=s.default;const o=i(n(6603));e.Collision=o.default},2714:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Level=void 0;const s=n(3427),o=i(n(1255)),a=i(n(9770)),r=n(9074),l=i(n(6514)),u=n(9325);var c;!function(t){t[t.All=0]="All",t[t.Walls=1]="Walls",t[t.Floors=2]="Floors",t[t.Ceils=3]="Ceils",t[t.Platforms=4]="Platforms"}(c||(c={}));class d{constructor(t){this.entities=[],this.elapsedSeconds=0,this.inAirTime=0,this.surfaceFilterCache=new Map;const[e,n]=d.splitConfig(t.walls);this.surfaces=d.initSurfaces(e,n),this.camera=new r.Camera(d.initArea(this.surfaces[c.All],t.minSize)),this.entitiesConfig=t.entities,this.loadEnter=n,this.loadExit=n.filter((t=>void 0!==t.zone)),t.music&&(this.music=t.music),t.backgrounds&&(this.bgs=t.backgrounds.map((t=>new u.SpriteAnimation(t))))}static newEntity(t,e){return new t(e)}static initEntities(t){return t.map((t=>d.newEntity(o.default[t.type],t.position)))}static getAngle(t){const e=t.A.minus(t.B);return Math.atan2(e.Y,e.X)}static getPerpOfLine(t){const e=d.perpLen/Math.hypot(t.Direction.X,t.Direction.Y),n=new s.Point(t.Direction.Y,t.Direction.X).multiply(e).minus(new s.Point(e/2,e/2));return[new s.Line(t.A.minus(n),t.A.plus(n)),new s.Line(t.B.minus(n),t.B.plus(n))]}static initSurfaces(t,e){e.reduce(((t,e)=>t.concat(d.getPerpOfLine(e.position))),[]).map((t=>({position:t})));const n=t.map((t=>Object.assign(Object.assign({platform:!1,type:a.default.Normal},t),{angle:d.getAngle(t.position)}))),i=Math.PI/2,o=n.map((t=>t.angle>0?Object.assign(Object.assign({},t),{position:new s.Line(t.position.B,t.position.A),angle:Math.abs(t.angle-i)}):Object.assign(Object.assign({},t),{angle:Math.abs(t.angle+i)}))),r=o.filter((t=>t.angle<=d.wallAngle)),l=o.filter((t=>t.angle>d.wallAngle)),u=l.filter((t=>!t.platform)),h=l.filter((t=>t.platform));return{[c.All]:o,[c.Walls]:r,[c.Floors]:l,[c.Ceils]:u,[c.Platforms]:h}}static initArea(t,e){const n=t.reduce(((t,e)=>Math.min(t,e.position.MinX)),0),i=t.reduce(((t,e)=>Math.max(t,e.position.MaxX)),0),o=Math.max(i-n+1,(null==e?void 0:e.X)||0),a=t.reduce(((t,e)=>Math.min(t,e.position.MinY)),0),r=t.reduce(((t,e)=>Math.max(t,e.position.MaxY)),0),l=Math.max(r-a+1,(null==e?void 0:e.Y)||0);return new s.Rectangle(n-1,a-1,o+1,l+1)}static splitConfig(t){return t.reduce(((t,e)=>{let n;return n=void 0!==e.levelId?[t[0],[...t[1],e]]:n=[[...t[0],e],t[1]],n}),[[],[]])}load(t,e=0,n=0,i=!1){i||(this.entities=d.initEntities(this.entitiesConfig)),this.char=t;const o=this.loadEnter[e<this.loadEnter.length?e:Math.floor(Math.random()*this.loadEnter.length)].position;this.camera.resetPosition();const a=o.MinX===o.MaxX?new s.Point(o.MinX,o.MaxY):o.B.minus(o.A).multiply(n).plus(o.A);this.char.levelLoad(a.minus(new s.Point(0,.1))),this.char.frame(1e-4),this.music&&l.default.music(this.music.url,this.music.loop),this.elapsedSeconds=0}processCollisions(t,e,n=!1){const i=new s.Point(t.Position.X,t.Position.Y),o=t.frame(e),a=new s.Line(i,t.Position);if(n){const t=r.Collision.processExitZones(this.loadExit,a);if(t)return t}const l=r.Collision.processCeil(this.surfaces[c.Ceils],t,a);l&&(t.Position.Y=l.point.Y+t.Collision.Height,t.resetVelocityY(!0));const u=!o&&r.Collision.processFloor(t,this.surfaces[c.Floors],a);u?(this.inAirTime=0,t.Position.Y=u.point.Y):this.inAirTime+=e;const d=r.Collision.processWalls(this.surfaces[c.Walls],t,a)||!u&&!l&&r.Collision.processCeil2(this.surfaces[c.Ceils],t,a);return d&&(t.Position.Y!==d.point.Y&&(t.Position.Y=d.point.Y,t.resetVelocityY()),(0===this.inAirTime||this.inAirTime>.05)&&t.Position.X!==d.point.X&&(t.Position.X=d.point.X,t.resetVelocityX())),t.Surface=u&&(null==u?void 0:u.surface)||d&&d.surface||null,null}frame(t,e,n){var i;const s=this.char,o=this.processCollisions(s,t,!0);if(o)return o;null===(i=this.entities)||void 0===i||i.forEach((e=>this.processCollisions(e,t))),this.camera.process(s,e,n,t),this.elapsedSeconds+=t}static drawLine(t,e,n,i){const s=i.A.multiply(e).minus(n),o=i.B.multiply(e).minus(n);t.moveTo(Math.round(s.X),Math.round(s.Y)),t.lineTo(Math.round(o.X),Math.round(o.Y))}static drawLines(t,e,n,i,s){if(!i.length)return;const o=t;t.beginPath(),o.strokeStyle=s,i.forEach((i=>d.drawLine(t,e,n,i.position))),t.stroke(),t.closePath()}surfaceFilter(t,e){const n=JSON.stringify([t,e]);return(this.surfaceFilterCache.has(n)?this.surfaceFilterCache:this.surfaceFilterCache.set(n,this.surfaces[t].filter((t=>t.type===e)))).get(n)}drawSurfaces(t,e,n){d.surfaceTypesKeys.forEach((i=>{const s=d.colors[i];t.setLineDash([15,5]),d.drawLines(t,e,n,this.surfaceFilter(c.Platforms,i),s),t.setLineDash([]),d.drawLines(t,e,n,this.surfaceFilter(c.Walls,i),s),d.drawLines(t,e,n,this.surfaceFilter(c.Ceils,i),s)}))}drawBgs(t,e){if(!this.bgs)return;const n=this.elapsedSeconds,i=s.Point.Zero.minus(this.camera.Current);this.bgs.forEach((s=>s.drawFrame(t,i,e,n,!1,1)))}draw(t,e,n=!1,i=!1){var s,o;const a=this.camera.Current,[r,l]=[.5,.5];t.translate(r,l),this.drawBgs(t,e),i&&(this.drawSurfaces(t,e,a),d.drawLines(t,e,a,this.loadEnter,"white"),d.drawLines(t,e,a,this.loadExit,"yellow")),t.translate(-r,-l),null===(s=this.char)||void 0===s||s.draw(t,a,e,n),null===(o=this.entities)||void 0===o||o.forEach((i=>i.draw(t,a,e,n)))}}e.Level=d,d.perpLen=20,d.wallAngle=0*Math.PI/180,d.colors={[a.default.Normal]:"#2F4F4F",[a.default.Ice]:"aqua"},d.surfaceTypesKeys=Object.keys(a.default).filter((t=>Number.isNaN(+t))).map((t=>a.default[t]))},3723:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(4640)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(48,0),c=[...(0,r.positionsFromPoints)([new s.Point(128,160),new s.Point(128,160)]).map((t=>Object.assign(Object.assign({},t),{levelId:l.default.Beggining}))),...(0,r.positionsFromPoints)([u,new s.Point(48,160),new s.Point(416,160),new s.Point(480,128),new s.Point(512,128),new s.Point(512,64),new s.Point(464,64),new s.Point(432,32),new s.Point(432,0),u]).map(((t,e)=>4===e?Object.assign(Object.assign({},t),{levelId:l.default.S2,zone:1}):t))],d={link:o.default,frameSize:512},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(d.frameSize,192)};e.default=h},179:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.test=0]="test",t[t.test2=1]="test2",t[t.WinTheGame=2]="WinTheGame",t[t.Beggining=3]="Beggining",t[t.S1=4]="S1",t[t.S2=5]="S2",t[t.S3=6]="S3",t[t.S4=7]="S4",t[t.S5=8]="S5",t[t.S6=9]="S6",t[t.S7=10]="S7",t[t.S8=11]="S8",t[t.S9=12]="S9",t[t.S10=13]="S10",t[t.S11=14]="S11",t[t.S12=15]="S12",t[t.S13=16]="S13",t[t.S14=17]="S14",t[t.S15=18]="S15",t[t.S16=19]="S16",t[t.S17=20]="S17"}(n||(n={})),e.default=n},9225:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LevelId=e.levelList=void 0;const s=n(3427),o=i(n(179));e.LevelId=o.default;const a=i(n(3411)),r=i(n(609)),l=i(n(3723)),u=i(n(8821)),c=i(n(5614)),d=i(n(5079)),h=i(n(7478)),f=i(n(6752)),m=i(n(590)),p=i(n(8045)),w=i(n(4384)),P=i(n(6295)),g=i(n(2157)),v=i(n(7878)),b=i(n(1754)),S=i(n(7490)),_=i(n(9779)),y=i(n(307)),M=i(n(7073)),O=i(n(2117)),j={minSize:s.Point.Zero,walls:[],entities:[]},L={[o.default.test]:a.default,[o.default.test2]:r.default,[o.default.WinTheGame]:j,[o.default.Beggining]:l.default,[o.default.S1]:u.default,[o.default.S2]:c.default,[o.default.S3]:d.default,[o.default.S4]:h.default,[o.default.S5]:f.default,[o.default.S6]:m.default,[o.default.S7]:p.default,[o.default.S8]:w.default,[o.default.S9]:P.default,[o.default.S10]:g.default,[o.default.S11]:v.default,[o.default.S12]:b.default,[o.default.S13]:S.default,[o.default.S14]:_.default,[o.default.S15]:y.default,[o.default.S16]:M.default,[o.default.S17]:O.default};e.levelList=L},2157:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(8240)),a=n(2311),r=n(7017),l=i(n(179)),u=i(n(9770)),c=[...(0,r.positionsFromPoints)([new s.Point(112,0),new s.Point(112,240),new s.Point(48,240),new s.Point(48,256),new s.Point(0,256),new s.Point(0,320),new s.Point(64,320)]).map(((t,e)=>4===e?Object.assign(Object.assign({},t),{levelId:l.default.S11,zone:3}):t)),...(0,r.positionsFromPoints)([new s.Point(80,336),new s.Point(80,448),new s.Point(0,448),new s.Point(0,512),new s.Point(80,512),new s.Point(112,512),new s.Point(112,640),new s.Point(0,640),new s.Point(0,704),new s.Point(32,704),new s.Point(64,736),new s.Point(432,736),new s.Point(464,704),new s.Point(512,704),new s.Point(512,640),new s.Point(416,640),new s.Point(432,592),new s.Point(432,432),new s.Point(416,432),new s.Point(416,336)]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S11,zone:2}):7===e?Object.assign(Object.assign({},t),{levelId:l.default.S11,zone:0}):13===e?Object.assign(Object.assign({},t),{levelId:l.default.S9,zone:4}):10===e?Object.assign(Object.assign({},t),{type:u.default.Ice}):t)),...(0,r.positionsFromPoints)([new s.Point(432,320),new s.Point(512,320),new s.Point(512,256),new s.Point(432,256),new s.Point(432,144)]).map(((t,e)=>1===e?Object.assign(Object.assign({},t),{levelId:l.default.S9,zone:2}):t)),...(0,r.positionsFromPoints)([new s.Point(432,128),new s.Point(512,128),new s.Point(512,64),new s.Point(432,64),new s.Point(432,0)]).map(((t,e)=>1===e?Object.assign(Object.assign({},t),{levelId:l.default.S9,zone:0}):t)),...(0,r.positionsFromPoints)([new s.Point(210,700),new s.Point(220,698),new s.Point(228,686),new s.Point(296,686),new s.Point(300,688)],!0),...(0,r.positionsFromPoints)([new s.Point(272,640),new s.Point(304,640)],!0),...(0,r.positionsFromPoints)([new s.Point(304,608),new s.Point(368,592),new s.Point(432,592)],!0),...(0,r.positionsFromPoints)([new s.Point(400,528),new s.Point(352,528)],!0),...(0,r.positionsFromPoints)([new s.Point(304,480),new s.Point(208,480),new s.Point(80,512)],!0),...(0,r.positionsFromPoints)([new s.Point(272,432),new s.Point(240,432)],!0),...(0,r.positionsFromPoints)([new s.Point(64,320),new s.Point(128,336),new s.Point(176,336)],!0),...(0,r.positionsFromPoints)([new s.Point(192,368),new s.Point(304,368)],!0),...(0,r.positionsFromPoints)([new s.Point(320,336),new s.Point(368,336),new s.Point(432,320)],!0),...(0,r.positionsFromPoints)([new s.Point(272,288),new s.Point(224,288)],!0),...(0,r.positionsFromPoints)([new s.Point(256,224),new s.Point(208,224)],!0),...(0,r.positionsFromPoints)([new s.Point(192,160),new s.Point(144,160)],!0),...(0,r.positionsFromPoints)([new s.Point(288,192),new s.Point(336,192)],!0),...(0,r.positionsFromPoints)([new s.Point(368,144),new s.Point(432,128)],!0)],d={link:o.default,frameSize:512},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.PitchBlackIntrussion],minSize:new s.Point(d.frameSize,768)};e.default=h},7878:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(5428)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(16,32),c=new s.Point(80,416),d=[...(0,r.positionsFromPoints)([c,new s.Point(80,544),new s.Point(192,544),new s.Point(224,512),new s.Point(256,512),new s.Point(256,448),new s.Point(224,448),new s.Point(192,416),c]).map(((t,e)=>4===e?Object.assign(Object.assign({},t),{levelId:l.default.S10,zone:2}):t)),...(0,r.positionsFromPoints)([u,new s.Point(16,256),new s.Point(0,256),new s.Point(0,320),new s.Point(48,320),new s.Point(80,352),new s.Point(192,352),new s.Point(224,320),new s.Point(256,320),new s.Point(256,256),new s.Point(224,256),new s.Point(192,224),new s.Point(64,224),new s.Point(64,256),new s.Point(48,256),new s.Point(48,224),new s.Point(48,160),new s.Point(192,160),new s.Point(224,128),new s.Point(256,128),new s.Point(256,64),new s.Point(224,64),new s.Point(192,32),new s.Point(64,32),new s.Point(64,64),new s.Point(48,64),new s.Point(48,32),u]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S12,zone:0}):8===e?Object.assign(Object.assign({},t),{levelId:l.default.S10,zone:1}):19===e?Object.assign(Object.assign({},t),{levelId:l.default.S10,zone:0}):t)),...(0,r.positionsFromPoints)([new s.Point(16,272),new s.Point(48,272)],!0),...(0,r.positionsFromPoints)([new s.Point(16,224),new s.Point(48,224)],!0),...(0,r.positionsFromPoints)([new s.Point(16,176),new s.Point(48,176)],!0)],h={link:o.default,frameSize:256},f={walls:d,entities:[],backgrounds:[h],music:a.musicList[a.MusicId.PitchBlackIntrussion],minSize:new s.Point(h.frameSize,576)};e.default=f},1754:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(1646)),a=n(2311),r=n(7017),l=i(n(179)),u=[...(0,r.positionsFromPoints)([new s.Point(32,32),new s.Point(32,176),new s.Point(192,176),new s.Point(224,144),new s.Point(224,128),new s.Point(256,128),new s.Point(256,64),new s.Point(224,64),new s.Point(224,32),new s.Point(32,32)]).map(((t,e)=>5===e?Object.assign(Object.assign({},t),{levelId:l.default.S11,zone:1}):t))],c={link:o.default,frameSize:256},d={walls:u,entities:[],backgrounds:[c],music:a.musicList[a.MusicId.ReincarnatedSouls],minSize:new s.Point(c.frameSize,192)};e.default=d},7490:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(6892)),a=n(2311),r=n(7017),l=i(n(179)),u=i(n(9770)),c=[...(0,r.positionsFromPoints)([new s.Point(432,128),new s.Point(512,128),new s.Point(512,64),new s.Point(432,64),new s.Point(432,16),new s.Point(48,16),new s.Point(48,256),new s.Point(0,256),new s.Point(0,320),new s.Point(64,320)]).map(((t,e)=>1===e?Object.assign(Object.assign({},t),{levelId:l.default.S14,zone:0}):7===e?Object.assign(Object.assign({},t),{levelId:l.default.S9,zone:3}):t)),...(0,r.positionsFromPoints)([new s.Point(64,320),new s.Point(64,432),new s.Point(48,432),new s.Point(48,512),new s.Point(272,512),new s.Point(272,544),new s.Point(432,544),new s.Point(464,512),new s.Point(512,512),new s.Point(512,448),new s.Point(416,448),new s.Point(416,320)]).map(((t,e)=>8===e?Object.assign(Object.assign({},t),{levelId:l.default.S14,zone:2}):5===e||3===e?Object.assign(Object.assign({},t),{type:u.default.Ice}):t)),...(0,r.positionsFromPoints)([new s.Point(416,320),new s.Point(432,320),new s.Point(432,240),new s.Point(416,240),new s.Point(416,192),new s.Point(432,176),new s.Point(432,144)]),...(0,r.positionsFromPoints)([new s.Point(192,400),new s.Point(224,400)],!0),...(0,r.positionsFromPoints)([new s.Point(240,352),new s.Point(288,352),new s.Point(416,320)],!0),...(0,r.positionsFromPoints)([new s.Point(224,144),new s.Point(288,128),new s.Point(432,128)],!0),...(0,r.positionsFromPoints)([new s.Point(64,320),new s.Point(176,320)],!0),...(0,r.positionsFromPoints)([new s.Point(48,272),new s.Point(80,272)],!0),...(0,r.positionsFromPoints)([new s.Point(48,240),new s.Point(80,240)],!0),...(0,r.positionsFromPoints)([new s.Point(48,208),new s.Point(80,208)],!0),...(0,r.positionsFromPoints)([new s.Point(48,176),new s.Point(80,176)],!0),...(0,r.positionsFromPoints)([new s.Point(48,144),new s.Point(80,144)],!0),...(0,r.positionsFromPoints)([new s.Point(170,478),new s.Point(180,476),new s.Point(188,464),new s.Point(256,464),new s.Point(260,466)],!0),...(0,r.positionsFromPoints)([new s.Point(336,500),new s.Point(368,500)],!0)],d={link:o.default,frameSize:512},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.PitchBlackIntrussion],minSize:new s.Point(d.frameSize,576)};e.default=h},9779:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(2170)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(0,64),c=new s.Point(0,448),d=[...(0,r.positionsFromPoints)([u,new s.Point(0,128),new s.Point(208,128),new s.Point(208,160),new s.Point(192,160),new s.Point(192,144),new s.Point(64,144),new s.Point(64,160),new s.Point(48,160),new s.Point(48,144),new s.Point(16,144),new s.Point(16,320),new s.Point(48,320),new s.Point(80,352),new s.Point(208,352),new s.Point(240,320),new s.Point(272,320),new s.Point(272,352),new s.Point(496,352),new s.Point(496,224),new s.Point(320,224),new s.Point(320,272),new s.Point(304,272),new s.Point(304,160),new s.Point(448,160),new s.Point(480,128),new s.Point(512,128),new s.Point(512,64),new s.Point(480,64),new s.Point(448,32),new s.Point(320,32),new s.Point(320,80),new s.Point(304,80),new s.Point(304,32),new s.Point(272,32),new s.Point(272,128),new s.Point(256,128),new s.Point(256,256),new s.Point(48,256),new s.Point(48,240),new s.Point(240,240),new s.Point(240,32),new s.Point(208,32),new s.Point(208,48),new s.Point(192,48),new s.Point(192,32),new s.Point(32,32),new s.Point(32,64),u]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S13,zone:0}):26===e?Object.assign(Object.assign({},t),{levelId:l.default.S15,zone:0}):t)),...(0,r.positionsFromPoints)([c,new s.Point(0,512),new s.Point(32,512),new s.Point(64,544),new s.Point(448,544),new s.Point(448,544),new s.Point(480,512),new s.Point(512,512),new s.Point(512,448),new s.Point(480,448),new s.Point(448,416),new s.Point(64,416),new s.Point(32,448),c]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S13,zone:2}):7===e?Object.assign(Object.assign({},t),{levelId:l.default.S17,zone:1}):t)),...(0,r.positionsFromPoints)([new s.Point(272,256),new s.Point(304,256)],!0),...(0,r.positionsFromPoints)([new s.Point(272,192),new s.Point(304,192)],!0),...(0,r.positionsFromPoints)([new s.Point(208,176),new s.Point(240,176)],!0),...(0,r.positionsFromPoints)([new s.Point(16,272),new s.Point(48,272)],!0)],h={link:o.default,frameSize:512},f={walls:d,entities:[],backgrounds:[h],music:a.musicList[a.MusicId.PitchBlackIntrussion],minSize:new s.Point(h.frameSize,576)};e.default=f},307:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(1216)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(0,64),c=[...(0,r.positionsFromPoints)([u,new s.Point(0,128),new s.Point(32,128),new s.Point(32,160),new s.Point(448,160),new s.Point(448,128),new s.Point(544,128),new s.Point(544,160),new s.Point(672,160),new s.Point(672,128),new s.Point(768,128),new s.Point(768,64),new s.Point(672,64),new s.Point(672,32),new s.Point(544,32),new s.Point(544,64),new s.Point(448,64),new s.Point(448,32),new s.Point(32,32),new s.Point(32,64),u]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S14,zone:1}):10===e?Object.assign(Object.assign({},t),{levelId:l.default.S6,zone:1}):t)),...(0,r.positionsFromPoints)([new s.Point(736,128),new s.Point(736,64)]),...(0,r.positionsFromPoints)([new s.Point(672,128),new s.Point(672,64)]).map((t=>Object.assign(Object.assign({},t),{levelId:l.default.WinTheGame,zone:-1})))],d={link:o.default,frameSize:768},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.PitchBlackIntrussion],minSize:new s.Point(d.frameSize,192)};e.default=h},7073:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(5314)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(0,256),c=[...(0,r.positionsFromPoints)([u,new s.Point(0,320),new s.Point(32,320),new s.Point(96,352),new s.Point(416,352),new s.Point(480,320),new s.Point(496,320),new s.Point(496,256),new s.Point(448,256),new s.Point(448,208),new s.Point(432,192),new s.Point(416,192),new s.Point(416,176),new s.Point(400,176),new s.Point(400,112),new s.Point(112,112),new s.Point(112,176),new s.Point(96,176),new s.Point(96,192),new s.Point(80,192),new s.Point(64,208),new s.Point(64,256),u]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S6,zone:1}):t))],d={link:o.default,frameSize:512},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(d.frameSize,384)};e.default=h},2117:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(6238)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(0,64),c=[...(0,r.positionsFromPoints)([u,new s.Point(0,128),new s.Point(32,128),new s.Point(64,160),new s.Point(224,160),new s.Point(224,128),new s.Point(256,128),new s.Point(256,32),new s.Point(64,32),new s.Point(32,64),u]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S14,zone:3}):t))],d={link:o.default,frameSize:272},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.PitchBlackIntrussion],minSize:new s.Point(d.frameSize,192)};e.default=h},8821:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(3201)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(256,64),c=[...(0,r.positionsFromPoints)([u,new s.Point(256,128),new s.Point(224,128),new s.Point(192,160),new s.Point(48,160),new s.Point(48,32),new s.Point(192,32),new s.Point(224,64),u]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S2,zone:0}):t))],d={link:o.default,frameSize:256},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.Beggining],minSize:new s.Point(d.frameSize,192)};e.default=h},5614:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(3235)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(48,0),c=[...(0,r.positionsFromPoints)([u,new s.Point(48,64),new s.Point(0,64),new s.Point(0,128),new s.Point(48,128),new s.Point(48,192),new s.Point(80,192),new s.Point(80,224),new s.Point(48,256),new s.Point(0,256),new s.Point(0,320),new s.Point(48,320),new s.Point(80,336),new s.Point(368,336),new s.Point(432,320),new s.Point(512,320),new s.Point(512,256),new s.Point(464,256),new s.Point(432,224),new s.Point(432,192),new s.Point(464,192),new s.Point(464,0),u]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S1,zone:0}):9===e?Object.assign(Object.assign({},t),{levelId:l.default.Beggining,zone:1}):15===e?Object.assign(Object.assign({},t),{levelId:l.default.S3,zone:0}):t)),...(0,r.positionsFromPoints)([new s.Point(176,144),new s.Point(336,144)],!0)],d={link:o.default,frameSize:512},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(d.frameSize,384)};e.default=h},5079:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(7970)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(48,0),c=[...(0,r.positionsFromPoints)([u,new s.Point(48,16),new s.Point(16,48),new s.Point(16,48),new s.Point(16,112),new s.Point(32,112),new s.Point(48,112),new s.Point(80,144),new s.Point(80,160),new s.Point(48,192),new s.Point(48,576),new s.Point(48,576),new s.Point(80,576),new s.Point(80,608),new s.Point(48,640),new s.Point(0,640),new s.Point(0,704),new s.Point(288,704),new s.Point(352,720),new s.Point(512,720),new s.Point(576,704),new s.Point(768,704),new s.Point(768,640),new s.Point(720,640),new s.Point(688,608),new s.Point(688,576),new s.Point(720,576),new s.Point(720,192),new s.Point(688,160),new s.Point(688,128),new s.Point(752,128),new s.Point(752,64),new s.Point(688,64),new s.Point(688,0),u]).map(((t,e)=>15===e?Object.assign(Object.assign({},t),{levelId:l.default.S2,zone:2}):21===e?Object.assign(Object.assign({},t),{levelId:l.default.S4,zone:0}):t)),...(0,r.positionsFromPoints)([new s.Point(80,144),new s.Point(208,176)],!0),...(0,r.positionsFromPoints)([new s.Point(256,240),new s.Point(304,240)],!0),...(0,r.positionsFromPoints)([new s.Point(352,176),new s.Point(496,176),new s.Point(688,128)],!0),...(0,r.positionsFromPoints)([new s.Point(48,280),new s.Point(80,288),new s.Point(208,288)],!0),...(0,r.positionsFromPoints)([new s.Point(208,304),new s.Point(336,304)],!0),...(0,r.positionsFromPoints)([new s.Point(368,416),new s.Point(432,416)],!0),...(0,r.positionsFromPoints)([new s.Point(512,320),new s.Point(576,304),new s.Point(720,304)],!0),...(0,r.positionsFromPoints)([new s.Point(48,448),new s.Point(160,448),new s.Point(480,528)],!0),...(0,r.positionsFromPoints)([new s.Point(576,608),new s.Point(608,608)],!0)],d={link:o.default,frameSize:768},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(d.frameSize,768)};e.default=h},7478:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(9999)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(48,0),c=[...(0,r.positionsFromPoints)([u,new s.Point(48,64),new s.Point(0,64),new s.Point(0,128),new s.Point(32,128),new s.Point(96,176),new s.Point(32,256),new s.Point(0,256),new s.Point(0,320),new s.Point(32,320),new s.Point(64,336),new s.Point(192,336),new s.Point(224,320),new s.Point(256,320),new s.Point(256,256),new s.Point(224,256),new s.Point(160,176),new s.Point(224,128),new s.Point(256,128),new s.Point(256,64),new s.Point(208,64),new s.Point(208,0),u]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S3,zone:1}):7===e?Object.assign(Object.assign({},t),{levelId:l.default.S8,zone:1}):13===e?Object.assign(Object.assign({},t),{levelId:l.default.S7,zone:0}):18===e?Object.assign(Object.assign({},t),{levelId:l.default.S5,zone:0}):t)),...(0,r.positionsFromPoints)([new s.Point(128,176),new s.Point(160,176)],!0),...(0,r.positionsFromPoints)([new s.Point(128,232),new s.Point(160,232)],!0),...(0,r.positionsFromPoints)([new s.Point(128,280),new s.Point(160,280)],!0)],d={link:o.default,frameSize:256},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(d.frameSize,384)};e.default=h},6752:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(8654)),a=n(2311),r=n(7017),l=i(n(179)),u=[...(0,r.positionsFromPoints)([new s.Point(48,0),new s.Point(48,256),new s.Point(0,256),new s.Point(0,320),new s.Point(32,320),new s.Point(96,352),new s.Point(928,352),new s.Point(992,320),new s.Point(1024,320),new s.Point(1024,256),new s.Point(960,256),new s.Point(960,224),new s.Point(992,224),new s.Point(992,0)]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S4,zone:3}):8===e?Object.assign(Object.assign({},t),{levelId:l.default.S6,zone:0}):t))],c={link:o.default,frameSize:1024},d={walls:u,entities:[],backgrounds:[c],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(c.frameSize,384)};e.default=d},590:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(6526)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(0,256),c=((0,r.positionsFromPoints)([u,new s.Point(0,320),new s.Point(96,480),new s.Point(160,480),new s.Point(160,512),new s.Point(96,512),new s.Point(96,608),new s.Point(128,608),new s.Point(128,640),new s.Point(16,640),new s.Point(16,704),new s.Point(96,704),new s.Point(160,736),new s.Point(320,736),new s.Point(384,704)]),[...(0,r.positionsFromPoints)([u,new s.Point(0,320),new s.Point(32,320),new s.Point(96,352),new s.Point(256,352),new s.Point(384,352),new s.Point(448,320),new s.Point(512,320),new s.Point(512,256),new s.Point(416,256),new s.Point(416,256),new s.Point(416,208),new s.Point(400,192),new s.Point(384,192),new s.Point(384,144),new s.Point(144,144),new s.Point(144,128),new s.Point(448,128),new s.Point(448,64),new s.Point(416,64),new s.Point(400,48),new s.Point(384,48),new s.Point(384,16),new s.Point(32,16),new s.Point(32,64),new s.Point(64,64),new s.Point(64,96),new s.Point(32,96),new s.Point(32,224),new s.Point(64,224),new s.Point(64,256),u]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S5,zone:1}):7===e?Object.assign(Object.assign({},t),{levelId:l.default.S16,zone:0}):t))].concat([])),d={link:o.default,frameSize:512},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(d.frameSize,768)};e.default=h},8045:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(9143)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(32,32),c=[...(0,r.positionsFromPoints)([u,new s.Point(32,64),new s.Point(0,64),new s.Point(0,128),new s.Point(32,128),new s.Point(32,144),new s.Point(64,176),new s.Point(224,176),new s.Point(224,32),u]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S4,zone:2}):t))],d={link:o.default,frameSize:256},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.ReincarnatedSouls],minSize:new s.Point(d.frameSize,192)};e.default=h},4384:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(3699)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(80,16),c=[...(0,r.positionsFromPoints)([u,new s.Point(80,64),new s.Point(0,64),new s.Point(0,128),new s.Point(32,128),new s.Point(64,160),new s.Point(80,160),new s.Point(144,176),new s.Point(336,176),new s.Point(400,160),new s.Point(416,160),new s.Point(480,128),new s.Point(512,128),new s.Point(512,64),new s.Point(480,64),new s.Point(448,32),new s.Point(448,16),u]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S9,zone:1}):12===e?Object.assign(Object.assign({},t),{levelId:l.default.S4,zone:1}):t))],d={link:o.default,frameSize:512},h={walls:c,entities:[],backgrounds:[d],music:a.musicList[a.MusicId.DraculasCastle],minSize:new s.Point(d.frameSize,192)};e.default=h},6295:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(714)),a=n(2311),r=n(7017),l=i(n(179)),u=new s.Point(32,16),c=new s.Point(0,256),d=new s.Point(0,640),h=[...(0,r.positionsFromPoints)([u,new s.Point(32,64),new s.Point(0,64),new s.Point(0,128),new s.Point(64,128),new s.Point(64,96),new s.Point(96,96),new s.Point(96,176),new s.Point(192,176),new s.Point(192,144),new s.Point(224,144),new s.Point(224,128),new s.Point(256,128),new s.Point(256,64),new s.Point(224,64),new s.Point(224,16),u]).map(((t,e)=>2===e?Object.assign(Object.assign({},t),{levelId:l.default.S10,zone:5}):12===e?Object.assign(Object.assign({},t),{levelId:l.default.S8,zone:0}):t)),...(0,r.positionsFromPoints)([c,new s.Point(0,320),new s.Point(208,320),new s.Point(208,352),new s.Point(192,352),new s.Point(192,336),new s.Point(64,336),new s.Point(64,352),new s.Point(48,352),new s.Point(48,336),new s.Point(16,336),new s.Point(16,512),new s.Point(48,512),new s.Point(80,544),new s.Point(192,544),new s.Point(224,512),new s.Point(256,512),new s.Point(256,448),new s.Point(48,448),new s.Point(48,432),new s.Point(240,432),new s.Point(240,224),new s.Point(208,224),new s.Point(208,240),new s.Point(192,240),new s.Point(192,224),new s.Point(32,224),new s.Point(32,256),c]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S10,zone:4}):16===e?Object.assign(Object.assign({},t),{levelId:l.default.S13,zone:1}):t)),...(0,r.positionsFromPoints)([d,new s.Point(0,704),new s.Point(32,704),new s.Point(64,736),new s.Point(160,736),new s.Point(160,608),new s.Point(64,608),new s.Point(32,640),d]).map(((t,e)=>0===e?Object.assign(Object.assign({},t),{levelId:l.default.S10,zone:3}):t)),...(0,r.positionsFromPoints)([new s.Point(208,368),new s.Point(240,368)],!0),...(0,r.positionsFromPoints)([new s.Point(16,464),new s.Point(48,464)],!0)],f={link:o.default,frameSize:256},m={walls:h,entities:[],backgrounds:[f],music:a.musicList[a.MusicId.PitchBlackIntrussion],minSize:new s.Point(f.frameSize,768)};e.default=m},609:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(9770)),a=i(n(4281)),r=n(7017),l=i(n(179)),u={walls:[...(0,r.positionsFromPoints)([new s.Point(150,199),new s.Point(150,200)]).map((t=>Object.assign(Object.assign({},t),{levelId:l.default.test2}))),...(0,r.positionsFromPoints)([s.Point.Zero,new s.Point(0,100),new s.Point(0,200),new s.Point(200,200),new s.Point(200,400),new s.Point(0,500),new s.Point(0,600),new s.Point(200,500),new s.Point(400,500),new s.Point(600,600),new s.Point(600,500),new s.Point(400,400),new s.Point(400,200),new s.Point(600,200),new s.Point(600,100),new s.Point(600,0),new s.Point(350,0),new s.Point(250,0),s.Point.Zero]).map(((t,e)=>7===e?Object.assign(Object.assign({},t),{type:o.default.Ice}):1===e?Object.assign(Object.assign({},t),{levelId:l.default.test2,zone:3}):5===e?Object.assign(Object.assign({},t),{levelId:l.default.test,zone:1}):9===e?Object.assign(Object.assign({},t),{levelId:l.default.test,zone:0}):13===e?Object.assign(Object.assign({},t),{levelId:l.default.test2,zone:1}):16===e?Object.assign(Object.assign({},t),{levelId:l.default.WinTheGame,zone:-1}):t)),...(0,r.positionsFromPoints)([new s.Point(200,400),new s.Point(250,400)]),...(0,r.positionsFromPoints)([new s.Point(350,400),new s.Point(400,400)]),...(0,r.positionsFromPoints)([new s.Point(250,300),new s.Point(350,300)]),...(0,r.positionsFromPoints)([new s.Point(200,200),new s.Point(250,200)]),...(0,r.positionsFromPoints)([new s.Point(350,200),new s.Point(400,200)]),...(0,r.positionsFromPoints)([new s.Point(250,100),new s.Point(350,100)])],entities:[],music:a.default};e.default=u},3411:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(3427),o=i(n(9770)),a=i(n(6615)),r=n(7017),l=i(n(179)),u=[...(0,r.positionsFromPoints)([s.Point.Zero,new s.Point(0,400),new s.Point(200,400),new s.Point(200,500),new s.Point(400,500),new s.Point(400,400),new s.Point(800,400),new s.Point(800,0),s.Point.Zero]),{position:new s.Rectangle(200,300,200,0).DiagonalA,platform:!0},{position:new s.Rectangle(150,50,150,150).DiagonalA,platform:!0},{position:new s.Rectangle(300,200,200,0).DiagonalA,platform:!0},...(0,r.positionsFromPoints)([new s.Point(780,250),new s.Point(750,250),new s.Point(650,300),new s.Point(600,340),new s.Point(560,350)]),...(0,r.positionsFromPoints)([new s.Point(550,250),new s.Point(560,240)]),...(0,r.positionsFromPoints)([new s.Point(200,400),new s.Point(210,400),new s.Point(210,500)]),...(0,r.positionsFromPoints)([new s.Point(750,200),new s.Point(700,160),new s.Point(610,130)],!0),...(0,r.positionsFromPoints)([new s.Point(250,450),new s.Point(350,420)],!1),...(0,r.positionsFromPoints)([new s.Point(200,210),new s.Point(240,240)],!1),...(0,r.positionsFromPoints)([new s.Point(750,20),new s.Point(800,20)]),...(0,r.positionsFromPoints)([new s.Point(750,120),new s.Point(800,120)])];u[1].type=o.default.Ice,u[5].type=o.default.Ice;const c=[{position:new s.Rectangle(100,100,0,100).DiagonalA,levelId:l.default.test},{position:new s.Rectangle(750,20,0,100).DiagonalA,levelId:l.default.test2,zone:1}],d={minSize:new s.Point(800,500),walls:u.concat(c),entities:[],music:a.default};e.default=d},6615:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s={url:i(n(6911)).default,loop:11.358};e.default=s},4281:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s={url:i(n(1362)).default,loop:21.418};e.default=s},6957:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s={url:i(n(3730)).default};e.default=s},7039:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s={url:i(n(8562)).default,loop:9.109};e.default=s},2311:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.musicList=e.MusicId=void 0;const s=i(n(6615)),o=i(n(4281)),a=i(n(6957)),r=i(n(7039));var l;!function(t){t[t.Beggining=0]="Beggining",t[t.DraculasCastle=1]="DraculasCastle",t[t.PitchBlackIntrussion=2]="PitchBlackIntrussion",t[t.ReincarnatedSouls=3]="ReincarnatedSouls"}(l||(l={})),e.MusicId=l;const u={[l.Beggining]:s.default,[l.DraculasCastle]:o.default,[l.PitchBlackIntrussion]:a.default,[l.ReincarnatedSouls]:r.default};e.musicList=u},3902:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.moveRight=0]="moveRight",t[t.moveLeft=1]="moveLeft",t[t.attackLight=2]="attackLight",t[t.attackHeavy=3]="attackHeavy",t[t.attackRange=4]="attackRange",t[t.jump=5]="jump",t[t.flipLeft=6]="flipLeft",t[t.flipRight=7]="flipRight",t[t.sit=8]="sit",t[t.run=9]="run",t[t.zoomUp=10]="zoomUp",t[t.zoomDown=11]="zoomDown",t[t.pause=12]="pause"}(n||(n={})),e.default=n},309:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ControlsAction=e.ControlsSettings=e.Controls=void 0;const s=i(n(3902));e.ControlsAction=s.default;const o=i(n(7695));e.ControlsSettings=o.default;class a{constructor(t){this.buttons=new Set,this.settings=t,this.initListeners()}initListeners(){document.addEventListener("keydown",this.buttonPress.bind(this)),document.addEventListener("keyup",this.buttonRelease.bind(this))}buttonPress(t){t.repeat||a.ignoreKeys.has(t.code)||this.buttons.add(t.code)}buttonRelease(t){t.preventDefault(),this.buttons.size&&this.buttons.delete(t.code)}has(t,e=!1){return[...this.settings.get(t)].some((t=>e?this.buttons.delete(t):this.buttons.has(t)))}}e.Controls=a,a.ignoreKeys=new Set(["ControlLeft","F5","F12","AltLeft","AltRight","Tab"])},7695:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(3902));e.default=class{constructor(){this.settings={[s.default.moveRight]:new Set(["KeyD","ArrowRight"]),[s.default.moveLeft]:new Set(["KeyA","ArrowLeft"]),[s.default.jump]:new Set(["KeyW","ArrowUp"]),[s.default.sit]:new Set(["KeyS","ArrowDown"]),[s.default.run]:new Set(["Space"]),[s.default.attackLight]:new Set(["KeyI","KeyZ","Numpad0"]),[s.default.attackHeavy]:new Set(["KeyO","KeyX","Numpad1"]),[s.default.attackRange]:new Set(["KeyP","KeyC","Numpad3"]),[s.default.zoomUp]:new Set(["Equal","NumpadAdd","PageUp"]),[s.default.zoomDown]:new Set(["Minus","NumpadSubtract","PageDown"]),[s.default.pause]:new Set(["Escape"]),[s.default.flipLeft]:new Set(["KeyQ","Numpad7"]),[s.default.flipRight]:new Set(["KeyE","Numpad9"])}}set(t,e){this.settings[t]=new Set(e)}get(t){return this.settings[t]}}},5341:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GameSettings=void 0;const i=n(3427);class s{constructor(t=0,e=10){this.drawBoxes=!1,this.drawSurfaces=!1,this.fpsDisplay=!0,this.timeDisplay=!0,this.fpsLimitSet=0,this.fpsLimitSafer=0,this.fpsLimitMin=15,this.frameTimeLimitMin=1/0,this.frameTimeLimit=1/0,this.renderSize=i.Point.Zero,this.renderZone=null,this.zoom=4,this.zoomMax=4,this.zoomMin=1,this.zoomSubscribers=[],this.FpsLimit=t,this.fpsLimitMin=e,this.frameTimeLimitMin=s.FpsToTimeLimit(e)}get DrawBoxes(){return this.drawBoxes}set DrawBoxes(t){this.drawBoxes=t}get DrawSurfaces(){return this.drawSurfaces}set DrawSurfaces(t){this.drawSurfaces=t}get FpsDisplay(){return this.fpsDisplay}set FpsDisplay(t){this.fpsDisplay=t}get TimeDisplay(){return this.timeDisplay}set TimeDisplay(t){this.timeDisplay=t}get FrameTimeLimit(){return this.frameTimeLimit}set FrameTimeLimit(t){this.FpsLimit=Math.ceil(1e3/t)}get FrameTimeLimitMin(){return this.frameTimeLimitMin}get FrameLimitSafer(){return this.fpsLimitSafer}set FrameLimitSafer(t){this.FpsLimit=t}get FpsLimitMin(){return this.fpsLimitMin}get FpsLimit(){return this.fpsLimitSet}set FpsLimit(t){this.fpsLimitSet=t,this.fpsLimitSafer=t&&Math.max(Math.min(t+s.fpsLimitAdd,t*s.fpsLimitMult),this.fpsLimitMin),this.frameTimeLimit=s.FpsToTimeLimit(this.fpsLimitSafer)}static FpsToTimeLimit(t){return 1e3/t}get RenderSize(){return this.renderSize}set RenderSize(t){this.renderSize=t}RenderSizeSet(t){this.renderSize=new i.Point(t.width,t.height)}RenderSizeGet(){return{width:this.renderSize.X,height:this.renderSize.Y}}setRenderZone(t){this.renderZone=t}getRenderZone(){return this.renderZone}get ZoomMax(){return this.zoomMax}get ZoomMin(){return this.zoomMin}get Zoom(){return this.zoom}set Zoom(t){const e=Math.min(this.zoomMax,Math.max(t,this.zoomMin));e!==this.zoom&&(this.zoom=e,this.zoomSubscribers.forEach((t=>t())))}ZoomChangeSubscribe(t){return this.zoomSubscribers.push(t),()=>{const e=this.zoomSubscribers.indexOf(t);e>-1&&this.zoomSubscribers.splice(e,1)}}}e.GameSettings=s,s.fpsLimitAdd=1,s.fpsLimitMult=1.1},8798:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SoundPlay=void 0;class n{constructor(){this.musicSubscribers=[],this.musicVolumeSubscribers=[],this.musicVolume=1,this.soundSubscribers=[],this.soundVolumeSubscribers=[],this.soundsVolume=1}get MusicVolume(){return this.musicVolume}set MusicVolume(t){this.musicVolume=t,this.musicVolumeSubscribers.forEach((e=>e(t)))}get SoundsVolume(){return this.soundsVolume}set SoundsVolume(t){this.soundsVolume=t,this.soundVolumeSubscribers.forEach((e=>e(t)))}static subscribe(t,e){return t.push(e),()=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)}}musicSubscribe(t){return n.subscribe(this.musicSubscribers,t)}soundSubscribe(t){return n.subscribe(this.soundSubscribers,t)}musicVolumeSubscribe(t){return t(this.musicVolume),n.subscribe(this.musicVolumeSubscribers,t)}soundVolumeSubscribe(t){return t(this.soundsVolume),n.subscribe(this.soundVolumeSubscribers,t)}playMusic(t,e){this.musicSubscribers.forEach((n=>n(t,e)))}playSound(t){this.soundSubscribers.forEach((e=>e(t)))}}e.SoundPlay=n},3427:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=e.Line=e.Point=void 0;const s=i(n(4847));e.Point=s.default;const o=i(n(542));e.Line=o.default;const a=i(n(2284));e.Rectangle=a.default},542:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(4847));class o{constructor(t,e){this.a=t,this.b=e,this.direction=e.minus(t),this.minX=Math.min(this.a.X,this.b.X),this.maxX=Math.max(this.a.X,this.b.X),this.minY=Math.min(this.a.Y,this.b.Y),this.maxY=Math.max(this.a.Y,this.b.Y),this.difXabs=this.maxX-this.minX,this.difYabs=this.maxY-this.minY}get A(){return this.a}get B(){return this.b}static get Zero(){return new o(s.default.Zero,s.default.Zero)}get Direction(){return this.direction}get MinX(){return this.minX}get MaxX(){return this.maxX}get MinY(){return this.minY}get MaxY(){return this.maxY}get DifXabs(){return this.difXabs}get DifYabs(){return this.difYabs}}e.default=o},4847:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t,e){this.x=t,this.y=e}get X(){return this.x}set X(t){this.x=t}get Y(){return this.y}set Y(t){this.y=t}static get Zero(){return new n(0,0)}plus(t){return new n(this.x+t.X,this.y+t.Y)}minus(t){return new n(this.x-t.X,this.y-t.Y)}multiply(t){return new n(this.x*t,this.y*t)}multiplyPoint(t){return new n(this.x*t.X,this.y*t.Y)}divide(t){return new n(this.x/t,this.y/t)}divideFloor(t){return new n(Math.floor(this.x/t),Math.floor(this.y/t))}}e.default=n},2284:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(542)),o=i(n(4847));class a{constructor(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i,this.right=this.x+this.width,this.bottom=this.y+this.height,this.size=new o.default(n,i),this.topLeft=new o.default(this.x,this.y),this.topRight=new o.default(this.right,this.y),this.bottomLeft=new o.default(this.x,this.bottom),this.bottomRight=new o.default(this.right,this.bottom),this.diagonalA=new s.default(this.topLeft,this.bottomRight),this.diagonalB=new s.default(this.topRight,this.bottomLeft),this.leftLine=new s.default(this.topLeft,this.bottomLeft),this.rightLine=new s.default(this.topRight,this.bottomRight),this.topLine=new s.default(this.topLeft,this.topRight),this.bottomLine=new s.default(this.bottomLeft,this.bottomRight)}get X(){return this.x}get Left(){return this.x}get Width(){return this.width}get Right(){return this.right}get Y(){return this.y}get Top(){return this.y}get Height(){return this.height}get Bottom(){return this.bottom}get DiagonalA(){return this.diagonalA}get DiagonalB(){return this.diagonalB}get LeftLine(){return this.leftLine}get RightLine(){return this.rightLine}get TopLine(){return this.topLine}get BottomLine(){return this.bottomLine}get TopLeft(){return this.topLeft}get TopRight(){return this.topRight}get BottomLeft(){return this.bottomLeft}get BottomRight(){return this.bottomRight}get Position(){return this.topLeft}get Size(){return this.size}static get Zero(){return new a(0,0,0,0)}static fromLine(t){return new a(t.MinX,t.MinY,t.MaxX-t.MinX,t.MaxY-t.MinY)}multiply(t){return new a(this.Left*t,this.Top*t,this.width*t,this.height*t)}plusPoint(t){return new a(this.Left+t.X,this.Top+t.Y,this.width,this.height)}minusPoint(t){return new a(this.Left-t.X,this.Top-t.Y,this.width,this.height)}}e.default=a},6514:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class n{static setSoundPlay(t){n.soundPlay=t}static sound(t){n.soundPlay.playSound(t)}static music(t,e){t!==n.currentMusic&&(n.currentMusic=t,n.soundPlay.playMusic(t,e))}}e.default=n},9325:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteAnimation=void 0;const i=n(3427);class s{constructor(t){this.frames=[],this.drawPosition=new i.Point(0,0),this.drawReversePosition=new i.Point(0,0),this.lastFrameEnds=0,this.currentFrame=0,s.checkConfig(t),this.sprite=t,this.imgSource=new Image,this.imgSource.src=t.link,this.imgSource.addEventListener("load",this.imgOnload.bind(this)),t.position&&(this.drawPosition=t.position,this.drawReversePosition=new i.Point(-t.position.X,t.position.Y))}get Ends(){return this.lastFrameEnds}static initFrames(t,e){let n=0,s=0,o=0;const a=[],r=e.vertical?t.naturalHeight:t.naturalWidth,l=(e.vertical?t.naturalWidth:t.naturalHeight)/(e.hasReverse?2:1);do{const t=e.frameSizeOverride&&e.frameSizeOverride[n]||e.frameSize;o+=e.frameLengthOverride&&e.frameLengthOverride[n]||e.frameLength||1;const r={position:e.vertical?new i.Rectangle(0,s,l,t):new i.Rectangle(s,0,t,l),ends:o};e.hasReverse&&(r.positionReverse=e.vertical?new i.Rectangle(l,s,l,t):new i.Rectangle(s,l,t,l)),a.push(r),n+=1,s+=t}while(s<r);return a}static isBelow0(t){return t<=0}static isAnyBelow0(t){return t&&Object.keys(t).find((t=>s.isBelow0(Number(t))))}static checkConfig(t){if(s.isBelow0(t.frameSize)||s.isAnyBelow0(t.frameSizeOverride))throw new Error(`${t.link} - frameWidth can't be below 1`);if(s.isBelow0(t.frameLength||1)||s.isAnyBelow0(t.frameLengthOverride))throw new Error(`${t.link} - frameLength can't be below 1`)}imgOnload(){this.frames=s.initFrames(this.imgSource,this.sprite),this.lastFrameEnds=this.frames.at(-1).ends}getFrame(t){if(!this.lastFrameEnds)return;const e=t%this.lastFrameEnds;for(;!(e>(this.currentFrame?this.frames[this.currentFrame-1].ends:0)&&e<this.frames[this.currentFrame].ends);)this.currentFrame+=1,this.currentFrame===this.frames.length&&(this.currentFrame=0);return this.frames[this.currentFrame]}static draw(t,e,n,i,o,a=8){const r=s.aligns[a](n,i,o);if(!r)throw new Error("align is not implemented");const l=i.Width>64||i.Height>64;e.drawImage(t,i.X,i.Y,i.Width,i.Height,Math.round(r.X)+(l?.5:0),Math.round(r.Y)+(l?.5:0),i.Width*o,i.Height*o)}drawFrame(t,e,n,i,o=!1,a=8){const r=this.getFrame(i);if(!r)return;const l=e.plus((o?this.drawReversePosition:this.drawPosition).multiply(n)),u=o&&r.positionReverse?r.positionReverse:r.position;s.draw(this.imgSource,t,l,u,n,a)}}e.SpriteAnimation=s,s.Empty={},s.aligns={1:t=>t,8:(t,e,n)=>new i.Point(Math.round(t.X-e.Width*n/2),Math.round(t.Y-e.Height*n))}},9770:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(5983));e.default=s.default},5983:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Normal=0]="Normal",t[t.Ice=1]="Ice"}(n||(n={})),e.default=n},3607:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),(new(i(n(1495)).default)).start()},1642:function(t,e){var n=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function r(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Api=void 0;class i{constructor(t){this.baseUrl=t}static getQueryString(t){return t?`?${Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&")}`:""}static getRequestInit(t,e){return{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}}static getUrl(t,e,n){return`${t}${e}${i.getQueryString(n)}`}getThisUrl(t,e){return i.getUrl(this.baseUrl,t,e)}get(t,e){return n(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t,e),{method:"GET"})}))}post(t,e){return n(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t),i.getRequestInit("POST",e))}))}put(t,e){return n(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t),i.getRequestInit("PUT",e))}))}delete(t){return n(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t),{method:"DELETE"})}))}patch(t,e){return n(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t,e),{method:"PATCH"})}))}}e.Api=i},4354:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function r(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TimeServices=void 0;const s=n(4530);class o extends s.ApiService{createTimeData(t){const e=Object.create(null,{create:{get:()=>super.create}});return i(this,void 0,void 0,(function*(){return yield e.create.call(this,t)}))}getTimesData(){const t=Object.create(null,{getAll:{get:()=>super.getAll}});return i(this,void 0,void 0,(function*(){return t.getAll.call(this,{})}))}getTimeData(t){const e=Object.create(null,{getId:{get:()=>super.getId}});return i(this,void 0,void 0,(function*(){return e.getId.call(this,t)}))}deleteTimeData(t){const e=Object.create(null,{delete:{get:()=>super.delete}});return i(this,void 0,void 0,(function*(){return e.delete.call(this,t)}))}updateTimeData(t){const e=Object.create(null,{update:{get:()=>super.update}});return i(this,void 0,void 0,(function*(){return e.update.call(this,t)}))}}e.TimeServices=o},7037:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function r(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.WinServices=void 0;const s=n(4530);class o extends s.ApiService{createWinData(t){const e=Object.create(null,{create:{get:()=>super.create}});return i(this,void 0,void 0,(function*(){return yield e.create.call(this,t)}))}getWinsData(){const t=Object.create(null,{getAll:{get:()=>super.getAll}});return i(this,void 0,void 0,(function*(){return t.getAll.call(this,{})}))}getWinData(t){const e=Object.create(null,{getId:{get:()=>super.getId}});return i(this,void 0,void 0,(function*(){return e.getId.call(this,t)}))}deleteWinData(t){const e=Object.create(null,{delete:{get:()=>super.delete}});return i(this,void 0,void 0,(function*(){return e.delete.call(this,t)}))}updateWinData(t){const e=Object.create(null,{update:{get:()=>super.update}});return i(this,void 0,void 0,(function*(){return e.update.call(this,t)}))}}e.WinServices=o},4530:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function r(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Api=e.ApiService=void 0;const s=n(1642);Object.defineProperty(e,"Api",{enumerable:!0,get:function(){return s.Api}}),e.ApiService=class{constructor(t,e,n){this.api=t,this.url=e,this.options=n}getIdUrl(t){return`${this.url}/${t}`}getAll(t){return i(this,void 0,void 0,(function*(){const e=yield this.api.get(this.url,t);if(!e.ok)return{totalCount:0};const n=e.headers.get(this.options.totalCount);return{totalCount:n?Number.parseInt(n,10):0,values:yield e.json()}}))}getId(t){return i(this,void 0,void 0,(function*(){const e=yield this.api.get(this.getIdUrl(t));return e.ok?e.json():e.status}))}create(t){return i(this,void 0,void 0,(function*(){const e=yield this.api.post(this.url,t);if(e.ok)return e.json()}))}delete(t){return i(this,void 0,void 0,(function*(){return(yield this.api.delete(this.getIdUrl(t))).ok}))}update(t){return i(this,void 0,void 0,(function*(){const e=yield this.api.put(this.url,t);return e.ok?e.json():void 0}))}}},786:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function r(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.UserServices=void 0;const s=n(4530);class o extends s.ApiService{createUser(t){const e=Object.create(null,{create:{get:()=>super.create}});return i(this,void 0,void 0,(function*(){const n=yield e.create.call(this,t);if(!n)throw new Error("this name is already taken");return n}))}getUsers(){const t=Object.create(null,{getAll:{get:()=>super.getAll}});return i(this,void 0,void 0,(function*(){return t.getAll.call(this,{})}))}getUser(t){const e=Object.create(null,{getId:{get:()=>super.getId}});return i(this,void 0,void 0,(function*(){return e.getId.call(this,t)}))}deleteUser(t){const e=Object.create(null,{delete:{get:()=>super.delete}});return i(this,void 0,void 0,(function*(){return e.delete.call(this,t)}))}updateUser(t){const e=Object.create(null,{update:{get:()=>super.update}});return i(this,void 0,void 0,(function*(){const n=yield e.update.call(this,t);if(!n)throw new Error("that user not found");return n}))}}e.UserServices=o},1999:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SoundPlay=e.ControlsAction=e.ControlsSettings=e.GameSettings=e.Api=e.ApiService=void 0;const i=n(4530);Object.defineProperty(e,"ApiService",{enumerable:!0,get:function(){return i.ApiService}}),Object.defineProperty(e,"Api",{enumerable:!0,get:function(){return i.Api}});const s=n(309);Object.defineProperty(e,"ControlsSettings",{enumerable:!0,get:function(){return s.ControlsSettings}}),Object.defineProperty(e,"ControlsAction",{enumerable:!0,get:function(){return s.ControlsAction}});const o=n(5341);Object.defineProperty(e,"GameSettings",{enumerable:!0,get:function(){return o.GameSettings}});const a=n(8798);Object.defineProperty(e,"SoundPlay",{enumerable:!0,get:function(){return a.SoundPlay}})},9457:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(5591)),o=i(n(3535)),a=n(8055),r=i(n(5429)),l=n(4989),u=i(n(3103)),c=i(n(4766)),d=i(n(6718)),h=i(n(819)),f=i(n(1815)),m=i(n(610));var p;!function(t){t[t.startPage=0]="startPage",t[t.canvas=1]="canvas",t[t.placeholder=2]="placeholder",t[t.sounds=3]="sounds",t[t.settingGame=4]="settingGame",t[t.settingControl=5]="settingControl",t[t.settingSound=6]="settingSound"}(p||(p={}));class w extends a.View{constructor(t,e){super(t,s.default,o.default),this.views={},this.services=e}createView(t){switch(t){case p.startPage:return new h.default(w.contentId,this.services);case p.canvas:{const t=new r.default(w.contentId,this.services.gameSettings);return this.game=new l.Game(this.services.controls.settings,this.services.gameSettings,this.services.sounds.play),this.game.start(this),t}case p.placeholder:return new u.default(w.contentId,this.services.api);case p.sounds:return new c.default("sounds",this.services.sounds.subsribe);case p.settingGame:return new d.default(w.contentId,this.services.gameSettings);case p.settingControl:return new f.default(w.contentId,this.services.controls.settings);case p.settingSound:return new m.default(w.contentId,this.services.sounds.settings);default:throw new Error(`${t} doesn't exit`)}}getView(t){return this.views[t]||(this.views[t]=this.createView(t)),this.views[t]}initListeners(){var t,e,n,i,s,o;null===(t=this.getElementById("toMainPage"))||void 0===t||t.addEventListener("click",this.changeTo.bind(this,p.startPage)),null===(e=this.getElementById("toCanvas"))||void 0===e||e.addEventListener("click",this.changeTo.bind(this,p.canvas)),null===(n=this.getElementById("toPlaceholder"))||void 0===n||n.addEventListener("click",this.changeTo.bind(this,p.placeholder)),null===(i=this.getElementById("toSettingGame"))||void 0===i||i.addEventListener("click",this.changeTo.bind(this,p.settingGame)),null===(s=this.getElementById("toSettingControl"))||void 0===s||s.addEventListener("click",this.changeTo.bind(this,p.settingControl)),null===(o=this.getElementById("settingSound"))||void 0===o||o.addEventListener("click",this.changeTo.bind(this,p.settingSound))}append(){super.append(),this.initListeners(),this.getView(p.sounds).append(),this.changeTo(p.startPage)}changeTo(t){return this.currentViewId!==t&&(this.currentViewId=t,this.getView(t).replace(),!0)}winTheGame(t){alert(JSON.stringify(t)),console.log(this),new u.default(w.contentId,this.services.api).postTimeData(+t.elapsedSeconds.toFixed(3)),new u.default(w.contentId,this.services.api).postWinData()}pauseTheGame(){alert("pause!"),console.log(this)}characterHp(t){alert(t),console.log(this)}}w.contentId=o.default.content,e.default=w},7075:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(8290)),o=i(n(8069)),a=n(8055);class r extends a.View{constructor(t,e){super(t,s.default,o.default),this.services=e,this.initAuthWindow()}initAuthWindow(){const t=this.getElementById("auth-user"),e=this.getElementById("auth-skip"),n=this.getElementById("togglePassVisibility");n.addEventListener("input",(()=>this.togglePassVisibility(n))),e.addEventListener("click",(()=>this.initStartButton())),t.addEventListener("click",(t=>{t.preventDefault();const e=this.makeUserData("auth");""===e.name||""===e.password?this.showContent("errorEmpty"):this.services.updateUser(this.makeUserData("auth")).then((()=>(this.hiddenContent("errorEmpty"),this.hiddenContent("errorMessage"),this.initStartButton()))).catch((()=>this.showContent("errorMessage")))}))}makeUserData(t){const e=this.getElementById(`name-${t}`),n=this.getElementById(`pass-${t}`);return localStorage.setItem("username",e.value.trim()),{name:e.value.trim(),password:n.value.trim()}}togglePassVisibility(t){const e=this.getElementById("pass-auth");!0===t.checked?e.type="text":e.type="password"}hiddenContent(t){this.getElementById(`${t}`).style.display="none"}initStartButton(){this.getElementById("startBtn").style.display="flex"}showContent(t){this.getElementById(`${t}`).style.display="flex"}}e.default=r},3103:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(5799)),o=i(n(4392)),a=n(8055);class r extends a.View{constructor(t,e){super(t,s.default,o.default),this.timeTable=this.getElementById("timeTable"),this.winTable=this.getElementById("winTable"),this.services=e,this.initTimeTable()}initTimeTable(){return this.getTable(),this.timeTable}getTable(){localStorage.getItem("username")&&(this.services.times.getTimesData().then((t=>{t.values&&this.drawTimeTable(t.values)})),this.services.wins.getWinsData().then((t=>{t.values&&this.drawWinTable(t.values)})))}postWinData(){if(!localStorage.getItem("username"))return;const t={name:r.getUserName(),win:"win",date:r.getDateAndTime()};this.services.wins.createWinData(t)}postTimeData(t){if(!localStorage.getItem("username"))return;const e={name:r.getUserName(),time:t,date:r.getDateAndTime()};this.services.times.createTimeData(e)}drawWinTable(t){this.winTable.innerHTML="";for(let e=0;e<t.length;e+=1)this.winTable.innerHTML+=r.drawTableCeil(t[e].name,t[e].win,t[e].date,!0)}drawTimeTable(t){this.timeTable.innerHTML="";for(let e=0;e<t.length;e+=1)this.timeTable.innerHTML+=r.drawTableCeil(t[e].name,t[e].time,t[e].date)}static drawTableCeil(t,e,n,i){return i?`\n        <tr>\n          <td>${t}</td>\n          <td style="color: green">${e}</td>\n          <td>${n}</td>\n        </tr>\n      `:`\n      <tr>\n        <td>${t}</td>\n        <td>${e}</td>\n        <td>${n}</td>\n      </tr>\n    `}static getDateAndTime(){return(new Date).toString().slice(0,24)}static getUserName(){return localStorage.getItem("username")}}e.default=r},5429:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(4340)),o=i(n(90)),a=n(8055);class r extends a.View{constructor(t,e){super(t,s.default,o.default),this.previousWindowWidth=0,this.previousWindowHeight=0,this.gameSettings=e,this.canvas=this.initCanvas(),this.gameSettings.setRenderZone(this.canvas.getContext("2d"));const n=this.setCanvasSize.bind(this);setTimeout(n),setInterval(n,500)}initCanvas(){const t=this.getElementById("canvas");return t.addEventListener("wheel",this.changeZoom.bind(this),{passive:!0}),window.addEventListener("resize",this.setCanvasSize.bind(this)),t}setCanvasSize(){if(this.previousWindowWidth===window.innerWidth&&this.previousWindowHeight===window.innerHeight)return;this.previousWindowWidth=window.innerWidth,this.previousWindowHeight=window.innerHeight,this.canvas.style.width="100%";const t=window.innerWidth-this.canvas.clientWidth,e=this.canvas.getBoundingClientRect().top,n=Math.floor(window.innerWidth-t),i=Math.floor(window.innerHeight-e-t);this.gameSettings.RenderSizeSet({width:n,height:i}),this.canvas.width=n,this.canvas.height=i,this.canvas.style.width=`${n}px`}changeZoom(t){this.gameSettings.Zoom+=t.deltaY<0?1:-1,this.setCanvasSize()}}e.default=r},8055:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;class n{constructor(t,e,i){this.parentId=t,this.templateItems=n.initTemplate(n.initTemplateString(e,i))}static initTemplateString(t,e){return Object.keys(e).reduce(((t,n)=>t.replace(new RegExp(`{{${n}}}`,"g"),e[n])),t)}setParent(t){this.parentId=t}static getParent(t){return document.getElementById(t)||document.getElementsByClassName(t)[0]||document.getElementsByTagName(t)[0]}getParent(){return n.getParent(this.parentId)}static initTemplate(t){const e=document.createElement("template");return e.innerHTML=t,[...e.content.children]}static getElementById(t,e){let i=t.find((t=>t.id===e));if(i)return i;for(let s=0;s<t.length;s+=1)if(t[s].children.length&&(i=n.getElementById([...t[s].children],e),i))return i}getElementById(t){return n.getElementById(this.templateItems,t)}replace(){const t=this.getParent();t&&(t.innerHTML="",this.append(t))}append(t=this.getParent()){t&&this.templateItems.forEach((e=>{t.append(e)}))}}e.View=n},2533:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(9366)),o=i(n(9762)),a=n(8055);class r extends a.View{constructor(t,e){super(t,s.default,o.default),this.services=e,this.initRegWindow()}initRegWindow(){const t=this.getElementById("reg-user"),e=this.getElementById("reg-skip"),n=this.getElementById("togglePassVisibilityReg");n.addEventListener("input",(()=>this.togglePassVisibility(n))),e.addEventListener("click",(()=>this.initStartButton())),t.addEventListener("click",(t=>{t.preventDefault();const e=this.makeUserData("reg");""===e.name||""===e.password?this.showContent("errorEmpty"):this.services.createUser(this.makeUserData("reg")).then((()=>(this.hiddenContent("errorMessage"),this.hiddenContent("errorEmpty"),this.initStartButton()))).catch((()=>this.showContent("errorMessage")))}))}makeUserData(t){const e=this.getElementById(`name-${t}`),n=this.getElementById(`pass-${t}`);return localStorage.setItem("username",e.value.trim()),{name:e.value.trim(),password:n.value.trim()}}togglePassVisibility(t){const e=this.getElementById("pass-reg");!0===t.checked?e.type="text":e.type="password"}showContent(t){this.getElementById(`${t}`).style.display="flex"}hiddenContent(t){this.getElementById(`${t}`).style.display="none"}initStartButton(){this.getElementById("startBtn").style.display="flex"}}e.default=r},1815:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(3956)),o=i(n(1260)),a=n(8055),r=n(1999),l=i(n(8326));class u extends a.View{constructor(t,e){super(t,s.default,o.default),this.controls=e,this.views=this.init()}init(){return Object.keys(r.ControlsAction).filter((t=>!Number.isNaN(Number(t)))).map((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:new l.default("setting__control",this.controls,e)})),{})}append(){super.append(),Object.values(this.views).forEach((t=>t.append()))}}e.default=u},8326:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(7509)),o=i(n(1260)),a=n(8055),r=n(1999);class l extends a.View{constructor(t,e,n){super(t,s.default,o.default),this.value=n,this.controlsSettings=e,this.init()}creteButton(t,e){const n=document.createElement("div");n.classList.add("value__seting"),n.id=t,n.textContent=t;const i=e;return n.addEventListener("click",(t=>{if(!t.target)return;t.preventDefault();const e=t.target.id,n=t.target;function s(t){t.target.classList.contains("value__seting")&&(t.stopPropagation(),t.preventDefault())}n.classList.add("add__value"),document.addEventListener("click",s,!0);const o="keypress",a=t=>{n.classList.remove("add__value"),n.textContent=t.code;const r=i.indexOf(e);i[r]=t.code,this.controlsSettings.set(this.value,i),document.removeEventListener("click",s,!0),window.removeEventListener(o,a)};window.addEventListener(o,a)})),n}init(){const t=this.getElementById("setting__class"),e=document.createElement("div");e.classList.add("name__seting"),t.appendChild(e),e.textContent=r.ControlsAction[this.value];const n=[...this.controlsSettings.get(this.value)];for(;n.length<3;)n.push("free");n.forEach((e=>{const i=this.creteButton(e,n);t.appendChild(i)}))}}e.default=l},6718:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(119)),o=i(n(3804)),a=n(8055);class r extends a.View{constructor(t,e){super(t,s.default,o.default),this.gameSettings=e,this.initSetting()}initSetting(){const t=this.getElementById("boxes__drow");t.checked=this.gameSettings.DrawBoxes,null==t||t.addEventListener("click",(()=>{this.gameSettings.DrawBoxes=t.checked}));const e=this.getElementById("fps__display");e.checked=this.gameSettings.FpsDisplay,null==e||e.addEventListener("click",(()=>{this.gameSettings.FpsDisplay=e.checked}));const n=this.getElementById("draw__surfaces");n.checked=this.gameSettings.DrawSurfaces,null==n||n.addEventListener("click",(()=>{this.gameSettings.DrawSurfaces=n.checked}));const i=this.getElementById("fps__Limit");i.value=String(this.gameSettings.FpsLimit),i.addEventListener("change",(t=>{const e=+t.target.value;this.gameSettings.FpsLimit=e}));const s=this.getElementById("zoom__game");s.value=String(this.gameSettings.Zoom),s.addEventListener("change",(t=>{const e=+t.target.value;this.gameSettings.Zoom=e}))}}e.default=r},610:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(1465)),o=i(n(4376)),a=n(8055);class r extends a.View{constructor(t,e){super(t,s.default,o.default),this.settingSound=e,this.init()}init(){const t=this.getElementById("music");t.value=String(this.settingSound.MusicVolume),null==t||t.addEventListener("change",(t=>{const e=Number(t.target.value);this.settingSound.MusicVolume=+e/100}));const e=this.getElementById("Sounds");e.value=String(this.settingSound.SoundsVolume),null==e||e.addEventListener("change",(t=>{const e=Number(t.target.value);this.settingSound.SoundsVolume=+e/100}))}}e.default=r},4766:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(4112)),o=i(n(6125)),a=n(8055);class r extends a.View{constructor(t,e){super(t,s.default,o.default),this.soundsActive=[],this.soundsIdle=[],this.soundVolume=1,this.musicLoop=null,this.musicSound=this.getElementById("music"),e.musicSubscribe(this.playMusic.bind(this)),e.soundSubscribe(this.playSound.bind(this)),e.musicVolumeSubscribe(this.setMusicVolume.bind(this)),e.soundVolumeSubscribe(this.setSoundVolume.bind(this)),this.soundsDiv=this.getElementById("sounds"),this.musicSound.addEventListener("timeupdate",this.musicCheck.bind(this))}playMusic(t,e){this.musicSound.src=t;const n=e||0;this.musicLoop=n<0?null:n}musicCheck(){this.musicSound.currentTime>this.musicSound.duration-r.buffer&&this.musicEnd()}musicEnd(){null!==this.musicLoop&&(this.musicSound.currentTime=this.musicLoop,this.musicSound.play())}getIdleSound(){if(this.soundsIdle.length)return this.soundsIdle.shift();const t=new Audio;return t.addEventListener("ended",this.soundEnded.bind(this)),t.volume=this.soundVolume,this.soundsDiv.append(t),t}playSound(t){const e=this.getIdleSound();e.src=t,e.load(),e.play(),this.soundsActive.push(e)}soundEnded(t){const e=this.soundsActive.indexOf(t.target);if(e<0)throw new Error("active sound not found");this.soundsIdle.push(this.soundsActive.splice(e,1)[0])}setMusicVolume(t){this.musicSound.volume=t}static setVolumeArr(t,e){for(let n=t.length-1;n>-1;n-=1)t[n].volume=e}setSoundVolume(t){this.soundVolume=t,r.setVolumeArr(this.soundsActive,t),r.setVolumeArr(this.soundsIdle,t)}}r.buffer=.32,e.default=r},819:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(8239)),o=i(n(8096)),a=i(n(2149)),r=n(8055),l=i(n(1996)),u=i(n(6718)),c=i(n(3103)),d=i(n(2533)),h=i(n(7075)),f=i(n(5429)),m=n(4989);class p extends r.View{constructor(t,e){super(t,l.default,a.default),this.services=e,this.mainPage=this.getElementById("startPage"),this.logoDiv=this.getElementById("logo"),this.regBtn=this.getElementById("registration"),this.authBtn=this.getElementById("login"),this.imgSource=new Image,this.imgSource.src=s.default,this.svgSource=o.default,this.modal=this.getElementById("modal"),this.closeBtn=this.getElementById("close"),this.modalContent=this.getElementById("modalContent"),this.initStartPage()}initStartPage(){this.mainPage.style.backgroundImage=`url(${this.imgSource.src})`,this.logoDiv.src=`${this.svgSource}`,this.addListeners()}addListeners(){var t;null===(t=this.getElementById("startPage"))||void 0===t||t.addEventListener("click",(t=>this.initPopup(t))),this.closeBtn.addEventListener("click",(()=>this.closePopup()))}initPopup(t){t.target===this.regBtn&&(this.showPopup(),new d.default("modalContent",this.services.api.users).append(),this.startGame()),t.target===this.getElementById("login")&&(this.showPopup(),new h.default("modalContent",this.services.api.users).append(),this.startGame()),t.target===this.getElementById("toSettingGame")&&(this.showPopup(),new u.default("modalContent",this.services.gameSettings).append()),t.target===this.getElementById("boarders")&&(this.showPopup(),new c.default("modalContent",this.services.api).append())}showPopup(){this.modal.style.display="flex",this.mainPage.classList.add("startPage__darken-overlay")}closePopup(){this.modalContent.innerHTML="",this.modal.style.display="none",this.mainPage.classList.remove("startPage__darken-overlay")}startGame(){var t;null===(t=this.getElementById("startBtn"))||void 0===t||t.addEventListener("click",(()=>{this.getElementById("startPage").style.display="none",this.modal.style.display="none";const t=new f.default("main",this.services.gameSettings).append();return this.game=new m.Game(this.services.controls.settings,this.services.gameSettings,this.services.sounds.play),this.game.start(),t}))}}e.default=p}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n(3607)})();