(()=>{"use strict";var t={333:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n=i.p+"340fb47fe5db94b7be1c182b5a72225c.png"},591:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n='<nav class="{{navigation}}"> <button id="toCanvas" class="{{button}} {{button_1}}">TO CANVAS</button> <button id="toPlaceholder" class="{{button}} {{button_1}}">TO PLACEHOLDER</button> </nav> <main class="{{content}}"></main> '},340:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n='<div class="canvas"> <div id="bg" class="{{bg}}">&nbsp;</div> <canvas id="canvas" class="{{canvas}}"></canvas> </div> '},903:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n='<div class="placeholder"> placeholder </div> '},535:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n={button:"app__button",button_1:"app__button_1",button_disabled:"app__button_disabled",content:"app__content",navigation:"app__navigation"}},90:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n={bg:"canvas__bg",canvas:"canvas__canvas"}},600:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});const n={}},495:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(999),r=n(i(457));class o{constructor(){this.contolsSettings=new s.ControlsSettings,new s.Api("http://localhost:3000/");const t={controls:{settings:new s.ControlsSettings,action:s.ControlsAction},gameSettings:new s.GameSettings,api:{placeholder1:null,placeholder2:null}};this.page=new r.default("body",t)}start(){this.page.append(),o.taskConsole()}static taskConsole(){}}e.default=o},192:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(427);class s{constructor(t){this.rect=new n.Rectangle(t.X-t.Width/2,-t.Y,t.Width,t.Height),this.rectReverse=new n.Rectangle(-t.X-t.Width/2,-t.Y,t.Width,t.Height),this.rectCombined=s.initCombined(this.rect,this.rectReverse)}get RectCombined(){return this.rectCombined}static initCombined(t,e){const i=Math.min(t.X,e.X),s=Math.max(t.X+t.Width,e.X+e.Width),r=Math.min(t.Y,e.Y),o=Math.min(t.Y,e.Y);return new n.Rectangle(i,s,r,o)}hit(t){throw new Error("Box.hit is not implemented!")}draw(t,e,i,n){const s=n?this.rectReverse:this.rect,r=Math.round(e.X+s.X*i),o=Math.round(e.Y+s.Y*i);t.strokeRect(r,o,s.Width*i,s.Height*i)}}e.default=s},241:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(309),r=i(861),o=i(427),a=i(238),l=n(i(770));class c extends r.Entity{constructor(t){super(o.Point.Zero,a.states),this.airJumps=1,this.jumpHold=!1,this.conrols=t}static getMaxVelX(t){return t?c.maxVelX.run:c.maxVelX.walk}processWalk(t,e,i,n){const s=this.OnSurface?c.getMaxVelX(t):Math.max(Math.abs(this.velocityPerSecond.X),c.maxVelX.walk);e&&(this.velocityPerSecond.X-=n,this.direction=r.Direction.left),i&&(this.velocityPerSecond.X+=n,this.direction=r.Direction.right),Math.abs(this.velocityPerSecond.X)>s&&(this.velocityPerSecond.X=e?-s:s)}processSlowDown(t){this.currentState!==a.CharacterState.Jump&&(this.velocityPerSecond.X<0?(this.velocityPerSecond.X+=t,this.velocityPerSecond.X>0&&(this.velocityPerSecond.X=0)):(this.velocityPerSecond.X-=t,this.velocityPerSecond.X<0&&(this.velocityPerSecond.X=0)))}processJump(){if(this.OnSurface&&(this.airJumps=1),this.conrols.has(s.ControlsAction.jump)){if(!this.jumpHold){if(this.OnSurface)this.surfaceType=null;else{if(!this.airJumps)return;this.airJumps-=1}this.velocityPerSecond.Y=-c.jumpPower,this.jumpHold=!0}}else this.jumpHold=!1}processControls(t){const e=this.conrols.has(s.ControlsAction.run),i=this.conrols.has(s.ControlsAction.moveLeft),n=this.conrols.has(s.ControlsAction.moveRight),r=t*(this.OnSurface?c.changeVelX[this.surfaceType]||c.changeVelX.default:c.changeVelX.air);i||n?this.processWalk(e,i,n,r):this.processSlowDown(r),this.processJump()}frame(t){this.processControls(t),super.frame(t)}}c.maxVelX={walk:100,run:180},c.changeVelX={default:1500,air:700,[l.default.Ice]:400},c.jumpPower=110,e.default=c},773:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(333)),r=i(427),o={link:s.default,frameLength:1/15,frameSize:43,vertical:!0,hasReverse:!0,position:new r.Point(-6,0)};e.default=o},23:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s={link:n(i(333)).default,frameLength:.05,frameSize:34};e.default=s},83:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(333)),r=i(427),o={link:s.default,frameLength:1/15,frameSize:43,vertical:!0,hasReverse:!0,position:new r.Point(-12,0)};e.default=o},238:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.states=e.CharacterState=void 0;const s=i(427),r=n(i(192)),o=n(i(83)),a=n(i(23)),l=n(i(773));var c;!function(t){t[t.Idle=0]="Idle",t[t.Walk=1]="Walk",t[t.Run=2]="Run",t[t.Jump=3]="Jump",t[t.AttackNormal=4]="AttackNormal",t[t.AttackHeavy=5]="AttackHeavy",t[t.AttackRange=6]="AttackRange"}(c||(c={})),e.CharacterState=c;const h=new r.default(new s.Rectangle(2,40,10,36)),u={[c.Idle]:{sprite:l.default,hurtbox:h},[c.Walk]:{sprite:o.default,hurtbox:h},[c.Run]:{sprite:a.default,hurtbox:h}};e.states=u},442:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(861),s=i(891);class r extends n.Entity{constructor(t){super(t,s.states)}}e.default=r},891:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.states=e.PlaceholderState=void 0,function(t){t[t.Idle=0]="Idle"}(i||(i={})),e.PlaceholderState=i;const n={[i.Idle]:{}};e.states=n},861:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.EntityId=e.Direction=e.Entity=void 0;const s=i(661);Object.defineProperty(e,"Direction",{enumerable:!0,get:function(){return s.Direction}}),Object.defineProperty(e,"EntityId",{enumerable:!0,get:function(){return s.EntityId}});const r=n(i(971)),o=i(427),a=n(i(192));class l{constructor(t,e,i){this.direction=s.Direction.right,this.position=o.Point.Zero,this.velocityPerSecond=o.Point.Zero,this.gravity=100,this.states={},this.stateElapsedSeconds=0,this.currentState=-1,this.animation=null,this.collision=o.Rectangle.Zero,this.surfaceType=null,this.position=t,e&&(this.states=l.initStates(e),this.State=i||Number(Object.keys(e)[0]))}get Direction(){return this.direction}set Position(t){this.position=t}get Position(){return this.position}get Collision(){return this.collision}set SurfaceType(t){t?this.velocityPerSecond.Y=0:this.OnSurface&&(this.velocityPerSecond.Y=this.gravity/1.8),this.surfaceType=t}get OnSurface(){return null!==this.surfaceType}static getCollisionSimplified(t){return t.map((t=>t.RectCombined)).reduce(((t,e)=>a.default.initCombined(t,e)))}set State(t){if(!this.states[t])return this.currentState=-1,this.animation=null,void(this.collision=o.Rectangle.Zero);this.currentState=t,this.collision=l.getCollisionSimplified(this.states[this.currentState].collisionboxes),this.animation=this.states[this.currentState].animation||null}static concatBoxes(t,e){return(e||[]).concat(t||[])}static initStates(t){return Object.keys(t).reduce(((e,i)=>{const n=t[+i],s=l.concatBoxes(n.hitbox,n.hitboxes),o=l.concatBoxes(n.hurtbox,n.hurtboxes),a=o.length?o:s,c=l.concatBoxes(n.collisionbox,n.collisionboxes),h={hitboxes:s,hurtboxes:a,collisionboxes:c.length?c:o};return n.sprite&&Object.assign(h,{animation:new r.default(n.sprite)}),Object.assign(e,{[+i]:h}),e}),{})}frame(t){this.stateElapsedSeconds+=t,this.OnSurface||(this.velocityPerSecond.Y<l.maxVelY&&(this.velocityPerSecond.Y+=t*this.gravity,this.velocityPerSecond.Y=Math.min(this.velocityPerSecond.Y,l.maxVelY)),this.position.Y+=t*this.velocityPerSecond.Y),this.position.X+=t*this.velocityPerSecond.X}static drawPosition(t,e){const i=t;i.strokeStyle=l.colors.position,i.fillRect(Math.round(e.X),Math.round(e.Y),1,1)}drawBoxes(t,e,i){if(this.currentState<0)return;const n=this.states[this.currentState],s=!!this.direction,r=t;t.translate(.5,.5),r.strokeStyle=l.colors.collision,n.hurtboxes.forEach((n=>n.draw(t,i,e,s))),r.strokeStyle=l.colors.hurt,n.hurtboxes.forEach((n=>n.draw(t,i,e,s))),r.strokeStyle=l.colors.hit,n.hitboxes.forEach((n=>n.draw(t,i,e,s))),l.drawPosition(t,i),t.translate(-.5,-.5)}draw(t,e,i,n=!1){const s=this.position.multiply(i).minus(e);if(this.animation){const e=this.stateElapsedSeconds;this.animation.drawFrame(t,s,i,e,!!this.direction)}n&&this.drawBoxes(t,i,s)}}e.Entity=l,l.maxVelY=500,l.colors={hit:"red",hurt:"blue",collision:"pink",position:"green"}},255:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(861),r=n(i(442)),o={[s.EntityId.Placeholder]:r.default};e.default=o},971:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(427);class s{constructor(t){this.frames=[],this.drawPosition=new n.Point(0,0),this.drawReversePosition=new n.Point(0,0),this.lastFrameEnds=0,this.currentFrame=0,s.checkConfig(t),this.sprite=t,this.imgSource=new Image,this.imgSource.src=t.link,this.imgSource.addEventListener("load",this.imgOnload.bind(this)),t.position&&(this.drawPosition=t.position,this.drawReversePosition=new n.Point(-t.position.X,t.position.Y))}get Ends(){return this.lastFrameEnds}static initFrames(t,e){let i=0,s=0,r=0;const o=[],a=e.vertical?t.naturalHeight:t.naturalWidth,l=(e.vertical?t.naturalWidth:t.naturalHeight)/(e.hasReverse?2:1);do{const t=e.frameSizeOverride&&e.frameSizeOverride[i]||e.frameSize;r+=e.frameLengthOverride&&e.frameLengthOverride[i]||e.frameLength;const a={position:e.vertical?new n.Rectangle(0,s,l,t):new n.Rectangle(s,0,t,l),ends:r};e.hasReverse&&(a.positionReverse=e.vertical?new n.Rectangle(l,s,l,t):new n.Rectangle(s,l,t,l)),o.push(a),i+=1,s+=t}while(s<a);return o}static isBelow0(t){return t<=0}static isAnyBelow0(t){return t&&Object.keys(t).find((t=>s.isBelow0(Number(t))))}static checkConfig(t){if(s.isBelow0(t.frameSize)||s.isAnyBelow0(t.frameSizeOverride))throw new Error(`${t.link} - frameWidth can't be below 1`);if(s.isBelow0(t.frameLength)||s.isAnyBelow0(t.frameLengthOverride))throw new Error(`${t.link} - frameLength can't be below 1`)}imgOnload(){this.frames=s.initFrames(this.imgSource,this.sprite),this.lastFrameEnds=this.frames.at(-1).ends}getFrame(t){if(!this.lastFrameEnds)return;const e=t%this.lastFrameEnds;for(;!(e>(this.currentFrame?this.frames[this.currentFrame-1].ends:0)&&e<this.frames[this.currentFrame].ends);)this.currentFrame+=1,this.currentFrame===this.frames.length&&(this.currentFrame=0);return this.frames[this.currentFrame]}static draw(t,e,i,n,s){e.drawImage(t,n.X,n.Y,n.Width,n.Height,Math.round(i.X-n.Width*s/2),Math.round(i.Y-n.Height*s),Math.round(n.Width*s),Math.round(n.Height*s))}drawFrame(t,e,i,n,r=!1){const o=this.getFrame(n);if(!o)return;const a=e.plus(r?this.drawReversePosition:this.drawPosition),l=r&&o.positionReverse?o.positionReverse:o.position;s.draw(this.imgSource,t,a,l,i)}}s.Empty={},e.default=s},929:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.right=0]="right",t[t.left=1]="left"}(i||(i={})),e.default=i},904:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Placeholder=0]="Placeholder"}(i||(i={})),e.default=i},661:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.EntityId=e.Direction=void 0;const s=n(i(929));e.Direction=s.default;const r=n(i(904));e.EntityId=r.default},989:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;const s=n(i(241)),r=i(309),o=i(714),a=n(i(753));class l{constructor(t,e){this.lastFrame=0,this.levels={},this.controls=new r.Controls(t),this.char=new s.default(this.controls),this.gameSettings=e,this.levelCurrent=this.changeLevel({levelId:o.LevelId.test,zone:0,position:1}),this.requestNextFrame()}getLevel(t){return this.levels[t]||(this.levels[t]=new o.Level(a.default[t])),this.levels[t]}changeLevel(t){const e=this.levelIdCurrent===t.levelId;return e||(this.levelIdCurrent=t.levelId,this.levelCurrent=this.getLevel(t.levelId)),this.levelCurrent.load(this.char,t.zone,t.position,e),this.levelCurrent}requestNextFrame(){window.requestAnimationFrame(this.frame.bind(this))}static drawFps(t,e,i){const n=t;n.font=`${e}px serif`,n.fillStyle="white",n.fillText(`FPS: ${(1e3/i).toFixed(1)}`,5,e)}processFrame(t){const e=this.gameSettings.getRenderZone();if(!e)throw l.RenderError;e.imageSmoothingEnabled=!1;const{RenderSize:i,Zoom:n}=this.gameSettings,s=this.levelCurrent.frame(t/1e3,i,n);e.clearRect(0,0,i.X,i.Y),this.levelCurrent.draw(e,n,this.gameSettings.DrawBoxes,this.gameSettings.DrawSurfaces),this.gameSettings.FpsDisplay&&l.drawFps(e,l.fontSize,t),s&&this.changeLevel(s)}frame(t){const e=t-this.lastFrame;this.controls.has(r.ControlsAction.zoomUp,!0)&&(this.gameSettings.Zoom+=1),this.controls.has(r.ControlsAction.zoomDown,!0)&&(this.gameSettings.Zoom-=1),(!Number.isFinite(this.gameSettings.FrameTimeLimit)||e>this.gameSettings.FrameTimeLimit)&&(this.lastFrame&&this.processFrame(e),this.lastFrame=t),this.requestNextFrame()}}e.Game=l,l.RenderError=new Error("the game can't process without canvas"),l.fontSize=24},714:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LevelId=e.Level=void 0;const s=i(47);Object.defineProperty(e,"LevelId",{enumerable:!0,get:function(){return s.LevelId}});const r=i(427),o=i(861),a=n(i(255)),l=n(i(770));class c{constructor(t){this.entities=[],this.cameraTarget=r.Point.Zero,this.cameraCurrent=r.Point.Zero,this.lastZoom=-1,this.lastViewSize=r.Point.Zero,this.size=t.size,this.surfaces=t.surfaces.map((t=>Object.assign(Object.assign({},t),{type:l.default.Normal,platform:!1}))),this.entitiesConfig=t.entities,this.loadEnter=t.loading,this.loadExit=t.loading.filter((t=>void 0!==t.zone))}static newEntity(t,e){return new t(e)}static initEntities(t){return t.map((t=>c.newEntity(a.default[t.type],t.position)))}load(t,e=0,i=0,n=!1){n||(this.entities=c.initEntities(this.entitiesConfig)),this.char=t;const s=this.loadEnter[e<this.loadEnter.length?e:Math.floor(Math.random()*this.loadEnter.length)].position;this.lastZoom=-1,this.char.Position=s.B.minus(s.A).multiply(i).plus(s.A),this.char.frame(1e-4)}static filterNear(t,e){return t.filter((t=>t.position.MinX<=e.Right&&t.position.MaxX>=e.Left&&t.position.MinY<=e.Bottom&&t.position.MaxY>=e.Top))}static linesIntersect(t,e){const i=t.B.minus(t.A),n=e.B.minus(e.A),s=(n.X*(t.A.Y-e.A.Y)-n.Y*(t.A.X-e.A.X))/(i.X*n.Y-i.Y*n.X);if(s<0||s>1||Number.isNaN(s))return null;const r=(i.X*(t.A.Y-e.A.Y)-i.Y*(t.A.X-e.A.X))/(i.X*n.Y-n.X*i.Y);return r<0||r>1||Number.isNaN(r)?null:s}static pointPercentOnLine(t,e,i){return Math.abs(t-e)/i}static processExitZones(t,e){if(!t.length)return null;for(let i=t.length-1;i>-1;i-=1){const n=t[i],s=n.position,r=c.linesIntersect(s,e);if(r)return{levelId:n.levelId,zone:n.zone,position:r}}return null}static processFloors(t,e,i){if(!t.length)return null;t.length>1&&t.sort(((t,e)=>e.position.MaxY-t.position.MaxY));for(let n=t.length-1;n>-1;n-=1){const s=t[n].position;if(!i){const t=c.pointPercentOnLine(e.A.X,s.A.X,s.DifXabs);if(s.DifYabs*t+s.MinY<e.A.Y)continue}const o=c.pointPercentOnLine(e.B.X,s.A.X,s.DifXabs),a=s.DifYabs*o+s.MinY;if(i||!(a>e.B.Y))return{surface:t[n],point:new r.Point(e.B.X,a)}}return null}static getCheckZone(t){const e=Math.floor(Math.min(t.B.Y,t.A.Y)),i=Math.ceil(Math.max(t.B.Y,t.A.Y)-e),n=Math.floor(Math.min(t.B.X,t.A.X)),s=Math.ceil(Math.max(t.B.X,t.A.X)-n);return new r.Rectangle(n,e,s,i)}processCollision(t,e,i=!1){const n=new r.Point(t.Position.X,t.Position.Y);t.frame(e);const s=new r.Line(n,t.Position),o=c.getCheckZone(s);if(i){const t=c.filterNear(this.loadExit,o),e=c.processExitZones(t,s);if(e)return e}const a=new r.Rectangle(s.B.X,o.Top,0,o.Height),l=c.filterNear(this.surfaces,a),h=c.processFloors(l,s,t.OnSurface);return h?(t.Position=h.point,t.SurfaceType=h.surface.type):t.SurfaceType=null,null}processCamera(t,e,i,n){const s=this.size.multiply(i);if(e.X>s.X)this.cameraTarget.X=(s.X-e.X)/2,this.cameraCurrent.X=this.cameraTarget.X;else{const n=i*t.Position.X-e.X*(.5+(t.Direction===o.Direction.left?c.cameraShift.X:-c.cameraShift.X)),r=s.X-e.X;this.cameraTarget.X=Math.min(Math.max(n,0),r)}if(e.Y>s.Y)this.cameraCurrent.Y=(s.Y-e.Y)/2;else{const n=i*t.Position.Y-e.Y*c.cameraShift.Y,r=s.Y-e.Y;this.cameraCurrent.Y=Math.min(Math.max(n,0),r)}if(this.lastZoom!==i||this.lastViewSize!==e)this.cameraCurrent.X=this.cameraTarget.X,this.lastZoom=i,this.lastViewSize=e;else if(this.cameraCurrent.X!==this.cameraTarget.X){const t=n*(c.cameraSpeed*i);this.cameraCurrent.X=this.cameraCurrent.X>this.cameraTarget.X?Math.max(this.cameraCurrent.X-t,this.cameraTarget.X):Math.min(this.cameraCurrent.X+t,this.cameraTarget.X)}}frame(t,e,i){var n;const s=this.char,r=this.processCollision(s,t,!0);if(r)return r;null===(n=this.entities)||void 0===n||n.forEach((e=>this.processCollision(e,t))),this.processCamera(s,e,i,t)}static drawLine(t,e,i,n){const s=n.A.multiply(e).minus(i),r=n.B.multiply(e).minus(i);t.moveTo(Math.round(s.X),Math.round(s.Y)),t.lineTo(Math.round(r.X),Math.round(r.Y))}static drawLines(t,e,i,n,s){const r=t;t.beginPath(),r.strokeStyle=s,n.forEach((n=>c.drawLine(t,e,i,n.position))),t.stroke(),t.closePath()}draw(t,e,i=!1,n=!1){var s,r;const o=this.cameraCurrent;null===(s=this.char)||void 0===s||s.draw(t,o,e,i),null===(r=this.entities)||void 0===r||r.forEach((n=>n.draw(t,o,e,i))),n&&(t.translate(.5,.5),c.drawLines(t,e,o,this.surfaces,"black"),c.drawLines(t,e,o,this.loadEnter,"white"),c.drawLines(t,e,o,this.loadExit,"yellow"),t.translate(-.5,-.5))}}e.Level=c,c.cameraSpeed=180,c.cameraShift=new r.Point(1/15,6/11)},376:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.surfaceConfigList=void 0;const n=i(373);Object.defineProperty(e,"surfaceConfigList",{enumerable:!0,get:function(){return n.surfaceConfigList}})},373:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.surfaceConfigList=void 0;const n=i(427);e.surfaceConfigList=t=>t.reduce(((t,e)=>{var i;return t.concat(new n.Line((null===(i=t.at(-1))||void 0===i?void 0:i.B)||n.Point.Zero,e))}),[]).slice(1).map((t=>({position:t})))},753:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(994)),r={[i(47).LevelId.test]:s.default};e.default=r},994:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(427),s=i(376),r=i(47),o=[],a=[];o.push(...(0,s.surfaceConfigList)([n.Point.Zero,new n.Point(0,400),new n.Point(200,400),new n.Point(200,500),new n.Point(400,500),new n.Point(400,400),new n.Point(800,400),new n.Point(800,0),n.Point.Zero])),o.push({position:new n.Rectangle(200,300,200,0).DiagonalA,platform:!0}),o.push({position:new n.Rectangle(100,0,200,200).DiagonalA,platform:!0},{position:new n.Rectangle(300,200,200,0).DiagonalA,platform:!0});const l=r.LevelId.test;a[0]={position:new n.Rectangle(100,100,0,100).DiagonalA},a[1]={position:new n.Rectangle(500,100,0,100).DiagonalA,levelId:l,zone:0},a[2]={position:new n.Rectangle(400,100,100,0).DiagonalA,levelId:l,zone:3},a[3]={position:new n.Rectangle(400,300,100,0).DiagonalA,levelId:l,zone:2},a[4]={position:new n.Rectangle(60,300,50,50).DiagonalB,levelId:l,zone:5},a[5]={position:new n.Rectangle(500,300,50,50).DiagonalB,levelId:l,zone:4};const c={size:new n.Point(800,500),surfaces:o,entities:[],loading:a};e.default=c},47:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.LevelId=void 0;const s=n(i(431));e.LevelId=s.default},431:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.test=0]="test"}(i||(i={})),e.default=i},902:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.moveRight=0]="moveRight",t[t.moveLeft=1]="moveLeft",t[t.jump=2]="jump",t[t.sit=3]="sit",t[t.run=4]="run",t[t.attackLight=5]="attackLight",t[t.attackHeavy=6]="attackHeavy",t[t.attackRange=7]="attackRange",t[t.zoomUp=8]="zoomUp",t[t.zoomDown=9]="zoomDown"}(i||(i={})),e.default=i},309:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ControlsAction=e.ControlsSettings=e.Controls=void 0;const s=n(i(902));e.ControlsAction=s.default;const r=n(i(695));e.ControlsSettings=r.default;class o{constructor(t){this.buttons=new Set,this.settings=t,this.initListeners()}initListeners(){document.addEventListener("keydown",this.buttonPress.bind(this)),document.addEventListener("keyup",this.buttonRelease.bind(this))}buttonPress(t){t.repeat||o.ignoreKeys.has(t.code)||(this.buttons.add(t.code),console.log("press",this.buttons))}buttonRelease(t){t.preventDefault(),this.buttons.size&&(this.buttons.delete(t.code),console.log("release",this.buttons))}has(t,e=!1){return[...this.settings.get(t)].some((t=>e?this.buttons.delete(t):this.buttons.has(t)))}}e.Controls=o,o.ignoreKeys=new Set(["ControlLeft","F5","F12","AltLeft","AltRight","Tab"])},695:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(902));e.default=class{constructor(){this.settings={[s.default.moveRight]:new Set(["KeyD","ArrowRight"]),[s.default.moveLeft]:new Set(["KeyA","ArrowLeft"]),[s.default.jump]:new Set(["KeyW","ArrowUp"]),[s.default.sit]:new Set(["KeyS","ArrowDown"]),[s.default.run]:new Set(["Space"]),[s.default.attackLight]:new Set(["KeyI"]),[s.default.attackHeavy]:new Set(["KeyO"]),[s.default.attackRange]:new Set(["KeyP"]),[s.default.zoomUp]:new Set(["Equal","NumpadAdd"]),[s.default.zoomDown]:new Set(["Minus","NumpadSubtract"])}}set(t,e){this.settings[t]=new Set(e)}get(t){return this.settings[t]}}},341:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GameSettings=void 0;const n=i(427);class s{constructor(t=0){this.drawBoxes=!0,this.drawSurfaces=!0,this.fpsDisplay=!0,this.fpsLimitSet=0,this.fpsLimitSafer=0,this.frameTimeLimit=1/0,this.renderSize=n.Point.Zero,this.renderZone=null,this.zoom=2,this.zoomSubscribers=[],this.FpsLimit=t}get DrawBoxes(){return this.drawBoxes}set DrawBoxes(t){this.drawBoxes=t}get DrawSurfaces(){return this.drawSurfaces}set DrawSurfaces(t){this.drawSurfaces=t}get FpsDisplay(){return this.fpsDisplay}set FpsDisplay(t){this.fpsDisplay=t}get FrameTimeLimit(){return this.frameTimeLimit}set FrameTimeLimit(t){this.FpsLimit=Math.ceil(1e3/t)}get FrameLimitSafer(){return this.fpsLimitSafer}set FrameLimitSafer(t){this.FpsLimit=t}get FpsLimit(){return this.fpsLimitSet}set FpsLimit(t){this.fpsLimitSet=t,this.fpsLimitSafer=t&&Math.min(t+s.fpsLimitAdd,t*s.fpsLimitMult),this.frameTimeLimit=1e3/this.fpsLimitSafer}get RenderSize(){return this.renderSize}set RenderSize(t){this.renderSize=t}RenderSizeSet(t){this.renderSize=new n.Point(t.width,t.height)}RenderSizeGet(){return{width:this.renderSize.X,height:this.renderSize.Y}}setRenderZone(t){this.renderZone=t}getRenderZone(){return this.renderZone}get Zoom(){return this.zoom}set Zoom(t){const e=Math.min(s.zoomMax,Math.max(t,1));e!==this.zoom&&(this.zoom=e,this.zoomSubscribers.forEach((t=>t())))}ZoomChangeSubscribe(t){return this.zoomSubscribers.push(t),()=>{const e=this.zoomSubscribers.indexOf(t);e>-1&&this.zoomSubscribers.splice(e,1)}}}e.GameSettings=s,s.fpsLimitAdd=1,s.fpsLimitMult=1.1,s.zoomMax=3},427:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=e.Line=e.Point=void 0;const s=n(i(847));e.Point=s.default;const r=n(i(542));e.Line=r.default;const o=n(i(284));e.Rectangle=o.default},542:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(847));class r{constructor(t,e){this.a=t,this.b=e,this.minX=Math.min(this.a.X,this.b.X),this.maxX=Math.max(this.a.X,this.b.X),this.minY=Math.min(this.a.Y,this.b.Y),this.maxY=Math.max(this.a.Y,this.b.Y),this.difXabs=this.maxX-this.minX,this.difYabs=this.maxY-this.minY}get A(){return this.a}get B(){return this.b}static get Zero(){return new r(s.default.Zero,s.default.Zero)}get MinX(){return this.minX}get MaxX(){return this.maxX}get MinY(){return this.minY}get MaxY(){return this.maxY}get DifXabs(){return this.difXabs}get DifYabs(){return this.difYabs}}e.default=r},847:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e){this.x=t,this.y=e}get X(){return this.x}set X(t){this.x=t}get Y(){return this.y}set Y(t){this.y=t}static get Zero(){return new i(0,0)}plus(t){return new i(this.x+t.X,this.y+t.Y)}minus(t){return new i(this.x-t.X,this.y-t.Y)}multiply(t){return new i(this.x*t,this.y*t)}divide(t){return new i(this.x/t,this.y/t)}divideFloor(t){return new i(Math.floor(this.x/t),Math.floor(this.y/t))}}e.default=i},284:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(542)),r=n(i(847));class o{constructor(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n,this.right=this.x+this.width,this.bottom=this.y+this.height;const o=new r.default(this.x,this.y),a=new r.default(this.right,this.y),l=new r.default(this.x,this.bottom),c=new r.default(this.right,this.bottom);this.diagonalA=new s.default(o,c),this.diagonalB=new s.default(a,l),this.leftLine=new s.default(o,l),this.rightLine=new s.default(a,c),this.topLine=new s.default(o,a),this.bottomLine=new s.default(l,c)}get X(){return this.x}get Left(){return this.x}get Width(){return this.width}get Right(){return this.right}get Y(){return this.y}get Top(){return this.y}get Height(){return this.height}get Bottom(){return this.bottom}get DiagonalA(){return this.diagonalA}get DiagonalB(){return this.diagonalB}get LeftLine(){return this.leftLine}get RightLine(){return this.rightLine}get TopLine(){return this.topLine}get BottomLine(){return this.bottomLine}static get Zero(){return new o(0,0,0,0)}}e.default=o},770:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(983));e.default=s.default},983:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Normal=0]="Normal",t[t.Ice=1]="Ice"}(i||(i={})),e.default=i},607:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),(new(n(i(495)).default)).start()},642:function(t,e){var i=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Api=void 0;class n{constructor(t){this.baseUrl=t}static getQueryString(t){return t?`?${Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&")}`:""}static getRequestInit(t,e){return{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}}static getUrl(t,e,i){return`${t}${e}${n.getQueryString(i)}`}getThisUrl(t,e){return n.getUrl(this.baseUrl,t,e)}get(t,e){return i(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t,e),{method:"GET"})}))}post(t,e){return i(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t),n.getRequestInit("POST",e))}))}put(t,e){return i(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t),n.getRequestInit("PUT",e))}))}delete(t){return i(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t),{method:"DELETE"})}))}patch(t,e){return i(this,void 0,void 0,(function*(){return fetch(this.getThisUrl(t,e),{method:"PATCH"})}))}}e.Api=n},530:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Api=e.ApiService=void 0;const s=i(642);Object.defineProperty(e,"Api",{enumerable:!0,get:function(){return s.Api}}),e.ApiService=class{constructor(t,e,i){this.api=t,this.url=e,this.options=i}getIdUrl(t){return`${this.url}/${t}`}getAll(t){return n(this,void 0,void 0,(function*(){const e=yield this.api.get(this.url,t);if(!e.ok)return{totalCount:0};const i=e.headers.get(this.options.totalCount);return{totalCount:i?Number.parseInt(i,10):0,values:yield e.json()}}))}getId(t){return n(this,void 0,void 0,(function*(){const e=yield this.api.get(this.getIdUrl(t));return e.ok?e.json():e.status}))}create(t){return n(this,void 0,void 0,(function*(){const e=yield this.api.post(this.url,t);return e.ok?e.json():void 0}))}delete(t){return n(this,void 0,void 0,(function*(){return(yield this.api.delete(this.getIdUrl(t))).ok}))}update(t,e){return n(this,void 0,void 0,(function*(){const i=yield this.api.put(this.getIdUrl(t),e);return i.ok?i.json():void 0}))}}},999:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ControlsAction=e.ControlsSettings=e.GameSettings=e.Api=e.ApiService=void 0;const n=i(530);Object.defineProperty(e,"ApiService",{enumerable:!0,get:function(){return n.ApiService}}),Object.defineProperty(e,"Api",{enumerable:!0,get:function(){return n.Api}});const s=i(309);Object.defineProperty(e,"ControlsSettings",{enumerable:!0,get:function(){return s.ControlsSettings}}),Object.defineProperty(e,"ControlsAction",{enumerable:!0,get:function(){return s.ControlsAction}});const r=i(341);Object.defineProperty(e,"GameSettings",{enumerable:!0,get:function(){return r.GameSettings}})},457:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(591)),r=n(i(535)),o=i(55),a=n(i(429)),l=i(989),c=n(i(555));var h;!function(t){t[t.canvas=0]="canvas",t[t.placaholder=1]="placaholder"}(h||(h={}));class u extends o.View{constructor(t,e){super(t,s.default,r.default),this.views={},this.services=e}createView(t){switch(t){case h.canvas:{const t=new a.default(u.contentId,this.services.gameSettings);return this.game=new l.Game(this.services.controls.settings,this.services.gameSettings),t}case h.placaholder:return new c.default(u.contentId,this.services);default:throw new Error(`${t} doesn't exit`)}}getView(t){return this.views[t]||(this.views[t]=this.createView(t)),this.views[t]}initListeners(){var t,e;null===(t=this.getElementById("toCanvas"))||void 0===t||t.addEventListener("click",this.changeTo.bind(this,h.canvas)),null===(e=this.getElementById("toPlaceholder"))||void 0===e||e.addEventListener("click",this.changeTo.bind(this,h.placaholder))}append(){super.append(),this.initListeners(),this.changeTo(h.canvas)}changeTo(t){return this.currentViewId!==t&&(this.currentViewId=t,this.getView(t).replace(),!0)}}u.contentId=r.default.content,e.default=u},429:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(340)),r=n(i(90)),o=i(55);class a extends o.View{constructor(t,e){super(t,s.default,r.default),this.previousWindowWidth=0,this.previousWindowHeight=0,this.bg=this.getElementById("bg"),this.gameSettings=e,this.canvas=this.initCanvas(),this.gameSettings.setRenderZone(this.canvas.getContext("2d"));const i=this.setCanvasSize.bind(this);setTimeout(i),setInterval(i,500)}initCanvas(){const t=this.getElementById("canvas");return t.addEventListener("mousemove",this.showCoords.bind(this)),t.addEventListener("mouseout",this.removeCoords.bind(this)),t.addEventListener("mouseout",this.removeCoords.bind(this)),t.addEventListener("wheel",this.changeZoom.bind(this)),t}showCoords(t){const e=t.target.getBoundingClientRect();this.bg.innerHTML=`x: ${(t.x-e.x).toString().padStart(4,"0")}, y:${(t.y-e.y).toString().padStart(4,"0")}`}removeCoords(){this.bg.innerHTML=" "}setCanvasSize(){if(this.previousWindowWidth===window.innerWidth&&this.previousWindowHeight===window.innerHeight)return;this.previousWindowWidth=window.innerWidth,this.previousWindowHeight=window.innerHeight,this.canvas.style.width="100%";const t=window.innerWidth-this.canvas.clientWidth,e=this.canvas.getBoundingClientRect().top,i=Math.floor(window.innerWidth-t),n=Math.floor(window.innerHeight-e-t);this.gameSettings.RenderSizeSet({width:i,height:n}),this.canvas.width=i,this.canvas.height=n,this.canvas.style.width=`${i}px`}changeZoom(t){this.gameSettings.Zoom+=t.deltaY<0?1:-1,this.setCanvasSize()}}e.default=a},55:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;class i{constructor(t,e,n){this.parentId=t,this.templateItems=i.initTemplate(i.initTemplateString(e,n))}static initTemplateString(t,e){return Object.keys(e).reduce(((t,i)=>t.replace(new RegExp(`{{${i}}}`,"g"),e[i])),t)}setParent(t){this.parentId=t}static getParent(t){return document.getElementById(t)||document.getElementsByClassName(t)[0]||document.getElementsByTagName(t)[0]}getParent(){return i.getParent(this.parentId)}static initTemplate(t){const e=document.createElement("template");return e.innerHTML=t,[...e.content.children]}static getElementById(t,e){let n=t.find((t=>t.id===e));if(n)return n;for(let s=0;s<t.length;s+=1)if(t[s].children.length&&(n=i.getElementById([...t[s].children],e),n))return n}getElementById(t){return i.getElementById(this.templateItems,t)}replace(){const t=this.getParent();t&&(t.innerHTML="",this.append(t))}append(t=this.getParent()){t&&this.templateItems.forEach((e=>{t.append(e)}))}}e.View=i},555:function(t,e,i){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=n(i(903)),r=n(i(600)),o=i(55);class a extends o.View{constructor(t,e){super(t,s.default,r.default),this.services=e}}e.default=a}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),i(607)})();